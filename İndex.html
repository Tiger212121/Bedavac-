<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BedavacÄ± - GÃ¼zellik Deneme AlanÄ±</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/face-landmarks-detection"></script>
</head>
<body>

    <header class="top-banner">
        <div class="banner-content">
            <div class="left-section">

        <div class="categories-menu">
                    <div class="categories-icon" id="categories-icon">
                        <svg viewBox="0 0 100 100">
                            <rect x="10" y="10" width="25" height="25" rx="3"></rect>

                    <rect x="45" y="10" width="45" height="25" rx="3"></rect>
                            <rect x="10" y="45" width="45" height="45" rx="3"></rect>
                            <rect x="65" y="45" width="25" height="45" rx="3"></rect>

               </svg>
                    </div>
                    <div class="categories-dropdown" id="categories-dropdown">
                        <a href="#" data-category="all">TÃ¼m ÃœrÃ¼nler</a>

        <a href="#" data-category="teknoloji">Teknoloji</a>
                        <a href="#" data-category="kozmetik">Kozmetik</a>
                        <a href="#" data-category="moda">Moda</a>
                        <a href="#" data-category="ev-yasam">Ev & YaÅŸam</a>

          </div>
                </div>
                <a href="#" class="site-name-wrapper" id="home-link">
                    <svg class="site-logo" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd">
                        <path d="M5 21h14c1.104 
0 2-.896 2-2V7c0-1.104-.896-2-2-2H5c-1.104 0-2 .896-2 2v12c0 1.104.896 2 2 2zM12 5c0-2.419-3.765-2.419-3.765 0h-1.558c-.911 0-1.677.766-1.677 1.677v.323h14v-.323c0-.911-.766-1.677-1.677-1.677h-1.558c0-2.419-3.765-2.419-3.765 0zM12 7c.828 0 1.5.672 1.5 1.5S12.828 10 12 10s-1.5-.672-1.5-1.5S11.172 7 12 7zm0-4c1.949 0 2.235 2.112 2.235 2.419H9.765C9.765 5.112 10.051 3 12 3z"/>
                    </svg>
                    <h1 class="site-name">BedavacÄ±</h1>
                </a>

    </div>
          
            <div class="right-section">
                <div class="profile-icon-wrapper" id="profile-icon-wrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>

           
                    <div class="profile-menu" id="profile-menu">
                        <div id="profile-menu-logged-out">
                            <div class="profile-menu-header simple">

                    <h4>HoÅŸ Geldiniz!</h4>
                                <p>FÄ±rsatlarÄ± kaÃ§Ä±rmamak iÃ§in giriÅŸ yapÄ±n veya kayÄ±t olun.</p>
                            </div>

                <div class="profile-menu-actions">
                                <button class="profile-menu-btn primary" id="menu-login-btn">GiriÅŸ Yap</button>
                                <button class="profile-menu-btn" id="menu-register-btn">KayÄ±t Ol</button>

                </div>
                        </div>

                        <div id="profile-menu-logged-in" style="display: none;">
                            <div class="profile-menu-header">

                            <div class="profile-avatar">
                                    <span id="user-initials"></span>
                                </div>

                              <div class="profile-user-info">
                                    <strong id="menu-username"></strong>

    <span id="menu-user-email"></span>
                                </div>
                            </div>
                            

                     <div class="profile-bc-summary">
                                <svg viewBox="0 0 512 512" class="bc-coin-icon"><path d="M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM256 48C141.1 48 48 141.1 48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 
48 256 48zM210.4 160C222.8 160 232.8 168.8 234.3 180.3L256 257.8L277.7 180.3C279.2 168.8 289.2 160 301.6 160H312C325.3 160 336 170.7 336 184C336 190.7 332.9 196.8 328.2 200.6L288 232L328.2 263.4C332.9 267.2 336 273.3 336 280C336 293.3 325.3 304 312 304H301.6C289.2 304 279.2 295.2 277.7 283.7L256 206.2L234.3 283.7C232.8 295.2 222.8 304 210.4 304H200C186.7 304 176 293.3 176 280C176 273.3 179.1 267.2 183.8 263.4L224 232L183.8 200.6C179.1 196.8 176 190.7 176 184C176 170.7 186.7 160 200 160H210.4z" fill="goldenrod"></path></svg>

    <span>BC PuanlarÄ±nÄ±z</span>
                                <strong id="menu-user-bc">0</strong>
                            </div>

                            <div class="profile-menu-links">

                           <div class="link-column">
                                    <a href="#" id="menu-profile-link" class="profile-menu-item">

       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                                        <span>Profilim</span>

       </a>
                                    <a href="#" id="menu-orders-link" class="profile-menu-item">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 
2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                                        <span>SipariÅŸlerim</span>
                                    </a>

                                 <a href="#" id="menu-favorites-link" class="profile-menu-item">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 
1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                                        <span>Favorilerim</span>
                                    </a>

               </div>
                                <div class="link-column">
                                    <a href="#" id="menu-coupons-link" class="profile-menu-item">

                           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg>
                                        <span>KuponlarÄ±m</span>

                               </a>
                                    <a href="#" id="menu-settings-link" class="profile-menu-item">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 
2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 
0-1.51 1z"></path></svg>
                                        <span>Ayarlar</span>
                                    </a>

             <a href="#" id="menu-help-link" class="profile-menu-item">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>

                        <span>YardÄ±m & Destek</span>
                                    </a>
                                </div>

                      </div>
                            
                            <div class="profile-menu-footer">

           <a href="#" id="menu-logout-btn" class="profile-menu-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>

                 <span>Ã‡Ä±kÄ±ÅŸ Yap</span>
                                </a>
                            </div>

  </div>
                    </div>
                </div>
             
                <a href="#" class="cart-section" id="cart-open-btn">
                    <div class="cart-icon-wrapper">

               <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                            <line x1="3" y1="6" 
x2="21" y2="6"></line>
                          
  <path d="M16 10a4 4 0 0 1-8 0"></path>
                        </svg>
                        <span class="cart-item-count" style="display: none;">0</span>

       </div>
                    
<span class="cart-text">Sepetim</span>
                </a>
            </div>
        </div>
        
    </header>

    <div class="modal-overlay" id="modal-overlay" style="display: none;">

        <div id="login-modal" class="modal-content enhanced" style="display: none;">
            <div class="modal-art-side" style="background-image: url('https://images.unsplash.com/photo-1556742502-ec7c0e9f34b1?auto=format&fit=crop&w=600');">
               
 <h3>BedavacÄ±'ya<br>Tekrar HoÅŸ Geldin!</h3>
                <p>En iyi fÄ±rsatlar seni bekliyor.</p>
            </div>
            <div class="modal-form-side">
                <span class="close-btn">&times;</span>

            <h2>GiriÅŸ Yap</h2>
                <form id="login-form">
 
                   <div class="form-group"><label for="login-username">KullanÄ±cÄ± AdÄ± veya E-posta</label><input type="text" id="login-username" required></div>
                    <div class="form-group"><label for="login-password">Åifre</label><input type="password" id="login-password" required></div>

   <button type="submit" class="modal-btn">GiriÅŸ Yap</button>
                </form>
         
       <div class="divider">veya</div>
                <div class="social-login-container">
                    <button class="social-btn google-btn" id="google-login-btn">

   <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Google</title><path d="M12.48 10.92v3.28h7.84c-.24 1.84-.85 3.18-1.73 4.1-1.02 1.02-2.37 1.62-3.82 1.62-4.66 0-8.42-3.82-8.42-8.5s3.76-8.5 8.42-8.5c2.58 0 4.25.98 5.26 1.94l2.38-2.38C19.34 1.34 16.34 0 12.48 0 5.6 0 0 5.6 0 12.5S5.6 25 12.48 25c7.2 0 11.94-4.82 11.94-12.1 0-.8-.08-1.54-.22-2.3z"/></svg>
                        <span>Google ile Devam Et</span>
                    </button>

    </div>
                <div class="switch-form-link"><p>Ãœye deÄŸil misin? <a id="show-register">KayÄ±t Ol</a></p></div>
            </div>
        </div>

        <div id="register-modal" class="modal-content enhanced" style="display: none;">
            <div class="modal-art-side" style="background-image: url('https://images.unsplash.com/photo-1589998059171-988d887df646?auto=format&fit=crop&w=600');">
                <h3>AramÄ±za<br>HoÅŸ Geldin!</h3>
                <p>Hesap oluÅŸtur ve kazanmaya baÅŸla.</p>
            </div>

           <div class="modal-form-side">
                <span class="close-btn">&times;</span>
                <h2>KayÄ±t Ol</h2>
                <form id="register-form">
                    <div class="form-group"><label for="reg-name">Ä°sim</label><input type="text" id="reg-name" required></div>

        <div class="form-group"><label for="reg-surname">Soyisim</label><input type="text" id="reg-surname" required></div>
                    <div class="form-group"><label for="reg-username">KullanÄ±cÄ± AdÄ±</label><input type="text" id="reg-username" required></div>
                    <div class="form-group"><label for="reg-email">E-posta</label><input type="email" id="reg-email" required></div>
                    <div class="form-group"><label for="reg-phone">Telefon</label><input type="tel" id="reg-phone" required></div>

         <div class="form-group"><label for="reg-password">Åifre</label><input type="password" id="reg-password" required></div>
                    <button type="submit" class="modal-btn">KayÄ±t Ol</button>
                </form>
                <div class="switch-form-link"><p>Zaten Ã¼ye misin? <a id="show-login">GiriÅŸ Yap</a></p></div>
            </div>
        </div>

        <div id="profile-modal" class="modal-content modal-content-profile" style="display: none; max-width: 800px;">
            <span class="close-btn">&times;</span>
            <div class="profile-modal-header">
                <h2>Profil YÃ¶netimi</h2>
                <p>Hesap bilgilerinizi gÃ¼ncelleyin ve tercihlerinizi yÃ¶netin.</p>
            </div>
            <div class="profile-modal-body">
                <div class="profile-tabs">
                    <button class="profile-tab-link active" data-tab="profile-overview">Genel BakÄ±ÅŸ</button>
                    <button class="profile-tab-link" data-tab="profile-edit">Bilgileri DÃ¼zenle</button>

           <button class="profile-tab-link" data-tab="profile-addresses">Adreslerim</button>
                </div>
                <div id="profile-overview" class="profile-tab-content active">
                    </div>
                <div id="profile-edit" class="profile-tab-content">

     <form id="profile-edit-form">
                        </form>
                </div>
                <div id="profile-addresses" class="profile-tab-content">
                     </div>
            </div>

     </div>

        <div id="orders-modal" class="modal-content" style="display: none;max-width: 900px;">
            <span class="close-btn">&times;</span>
            <div class="modal-header-enhanced">
                <h2>SipariÅŸlerim</h2>
                <div class="order-filters">
                    <select id="order-status-filter">

     <option value="all">TÃ¼m Durumlar</option>
                        <option value="HazÄ±rlanÄ±yor">HazÄ±rlanÄ±yor</option>
                        <option value="Kargoda">Kargoda</option>
                        <option 
value="Teslim Edildi">Teslim Edildi</option>
                
     </select>
                </div>
            </div>
            <div id="orders-list-container" class="enhanced-list-container">
                </div>
        </div>
        

     <div id="favorites-modal" class="modal-content" style="display: none;max-width: 900px;">
            <span class="close-btn">&times;</span>
             <div class="modal-header-enhanced">
                <h2>Favorilerim</h2>
                <button id="add-all-fav-to-cart-btn" class="modal-header-btn">TÃ¼mÃ¼nÃ¼ Sepete Ekle</button>
            </div>
            <div id="favorites-list-container" class="enhanced-list-container">

        </div>
        </div>

        <div id="coupons-modal" class="modal-content" style="display: none;max-width: 600px;">
            <span class="close-btn">&times;</span>
            <h2>KuponlarÄ±m</h2>
            <div class="coupon-tabs">
                <button class="coupon-tab-link active" data-tab="active-coupons">Aktif Kuponlar</button>

             <button class="coupon-tab-link" data-tab="expired-coupons">GeÃ§miÅŸ Kuponlar</button>
            </div>
          
   <div id="active-coupons" class="coupon-tab-content active">
                </div>
            <div id="expired-coupons" class="coupon-tab-content">
                 </div>
        </div>


       <div id="settings-modal" class="modal-content" style="display: none;max-width: 700px;">
            <span class="close-btn">&times;</span>
            <h2>Ayarlar</h2>
            <div class="settings-container">
                <div class="settings-sidebar">
                    <a href="#" class="settings-menu-item active" data-target="setting-notifications">Bildirimler</a>

 <a href="#" class="settings-menu-item" data-target="setting-privacy">Gizlilik</a>
                    <a href="#" class="settings-menu-item" data-target="setting-theme">GÃ¶rÃ¼nÃ¼m</a>
                </div>
                <div class="settings-content">
                    <div id="setting-notifications" class="setting-pane active">

       <h4>Bildirim Tercihleri</h4>
                        <p>Hangi konularda e-posta ve anlÄ±k bildirim almak istersiniz?</p>
                        <div class="setting-option">

    <label for="notif-offers">Ã–zel FÄ±rsatlar ve Ä°ndirimler</label>
     
                         <input type="checkbox" id="notif-offers" class="toggle-switch" checked>
                        </div>
                        <div class="setting-option">

     <label for="notif-stock">Stok ve Fiyat AlarmlarÄ±</label>
                            <input type="checkbox" id="notif-stock" class="toggle-switch" checked>
                        </div>

     <div class="setting-option">
          
                   <label for="notif-order">SipariÅŸ Durum GÃ¼ncellemeleri</label>
                            <input type="checkbox" id="notif-order" class="toggle-switch" checked>
                        </div>

             </div>
   
                 <div id="setting-privacy" class="setting-pane">
                        <h4>Gizlilik AyarlarÄ±</h4>
                        <p>Verilerinizin nasÄ±l kullanÄ±ldÄ±ÄŸÄ±nÄ± yÃ¶netin.</p>

             <div class="setting-option">
   
                             <label for="privacy-data">KiÅŸiselleÅŸtirilmiÅŸ Ã–neriler</label>
                            <input type="checkbox" id="privacy-data" class="toggle-switch" checked>

    </div>
                 
        <a href="#" class="settings-link">Gizlilik PolitikasÄ±'nÄ± Oku</a>
                    </div>
                    <div id="setting-theme" class="setting-pane">
                        <h4>GÃ¶rÃ¼nÃ¼m</h4>

 <p>Site temasÄ±nÄ± kiÅŸiselleÅŸtirin.</p>
                        <div class="theme-selector">
                            <button class="theme-option" data-theme="light">AÃ§Ä±k Tema</button>

         <button class="theme-option" data-theme="dark">Koyu Tema (YakÄ±nda)</button>
         
               </div>
                    </div>
                </div>
            </div>
        </div>

        
<div id="help-modal" class="modal-content" style="display: none;max-width: 800px;">
            <span class="close-btn">&times;</span>
            <h2>YardÄ±m & Destek</h2>
            <div class="help-container">
                <h4>SÄ±kÃ§a Sorulan Sorular (SSS)</h4>
                <div class="accordion">

 <div class="accordion-item">
  
                       <button class="accordion-header">SipariÅŸimi nasÄ±l takip edebilirim?</button>
                        <div class="accordion-content">
                            <p>SipariÅŸlerim sayfasÄ±ndan ilgili sipariÅŸinizin yanÄ±ndaki "Kargo Takip" butonuna tÄ±klayarak anlÄ±k durumunu gÃ¶rebilirsiniz.</p>

               </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-header">Ä°ade ve deÄŸiÅŸim sÃ¼reci nasÄ±l iÅŸliyor?</button>

         <div class="accordion-content">
                            <p>ÃœrÃ¼nÃ¼ teslim aldÄ±ktan sonra 30 gÃ¼n iÃ§inde Ã¼cretsiz iade hakkÄ±nÄ±z bulunmaktadÄ±r. Profilim > SipariÅŸlerim sayfasÄ±ndan iade talebi oluÅŸturabilirsiniz.</p>
                        </div>
                    </div>
 
                   <div class="accordion-item">
                        <button class="accordion-header">BC PuanlarÄ±mÄ± nasÄ±l kullanabilirim?</button>

                       <div class="accordion-content">
                           
 <p>KazandÄ±ÄŸÄ±nÄ±z BC PuanlarÄ±nÄ± Ã¶deme aÅŸamasÄ±nda indirim olarak kullanabilirsiniz. 100 BC PuanÄ±, 1 TL deÄŸerindedir.</p>
                        </div>
                    </div>
                </div>
                <div class="contact-support">

   <h4>AradÄ±ÄŸÄ±nÄ±zÄ± BulamadÄ±nÄ±z mÄ±?</h4>
                    <p>MÃ¼ÅŸteri hizmetlerimizle iletiÅŸime geÃ§in.</p>
                    <button class="contact-btn">CanlÄ± Destek (YakÄ±nda)</button>
                    <button class="contact-btn">destek@bedavaci.com</button>
                </div>

         </div>
        </div>
        
   <div id="bc-modal" class="modal-content modal-content-bc" style="display: none;">
            <span class="close-btn">&times;</span>
            <h2 id="bc-modal-title">BC PuanlarÄ±n</h2>
            <p id="bc-modal-amount">0</p>
        </div>

        <div id="tracking-modal" class="modal-content" style="display: none; max-width: 600px;">
      
       <span 
class="close-btn">&times;</span>
            <h2 id="tracking-modal-title">Kargo Takip</h2>
            <div id="tracking-timeline-container" class="tracking-timeline"></div>
        </div>

        <div id="productDetailModal" class="modal-content" style="display:none; max-width: 950px; padding: 0; overflow: hidden;">
            <span class="close-btn">&times;</span>
            <div class="detail-modal-layout-new">
                
                <div class="detail-gallery">
                    <div class="detail-main-image-wrapper">
                        <img id="detailMainImage" src="https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-pro-finish-select-202309-6-1inch-naturaltitanium?wid=5120&hei=2880&fmt=p-jpg&qlt=80&.v=1692845699492" alt="ÃœrÃ¼n">
                    </div>
                    <div class="detail-thumbnail-wrapper" id="detailThumbnails">
                        </div>
                </div>
                
                <div class="detail-info">
                    <h2 id="detailNameNew">ÃœrÃ¼n AdÄ± Buraya Gelecek</h2>
                    <div class="detail-meta">
                        <div class="detail-stars" id="detailRatingStars">â˜…â˜…â˜…â˜…â˜†</div>
                        <span id="detailReviewCount">(0 Yorum)</span>
                        <span class="detail-separator">|</span>
                        <span id="detailStockStatus" class="stock-status">Stok Durumu</span>
                    </div>
                    <div class="detail-price-new">
                        <span id="detailPriceNew">0.00 â‚º</span>
                        <span id="detailDiscountNew">0.00 â‚º</span>
                    </div>
                    <p id="detailDescription" class="detail-description">Bu alana Ã¼rÃ¼nÃ¼n dikkat Ã§ekici, kÄ±sa ve Ã¶z aÃ§Ä±klamasÄ± gelecek. MÃ¼ÅŸterinin ilgisini Ã§ekecek bilgiler burada yer almalÄ±.</p>
                    
                    <div class="detail-options">
                        <div class="option-group" id="detailColorsContainer" style="display:none;">
                            <label>Renk:</label>
                            <div class="color-selector" id="detailColorSelector"></div>
                        </div>
                        <div class="option-group" id="detailSizesContainer" style="display:none;">
                            <label>Beden:</label>
                            <div class="size-selector-detail" id="detailSizeSelector"></div>
                        </div>
                        <div class="option-group">
                            <label>Adet:</label>
                            <div class="quantity-control-detail">
                                <button class="quantity-btn-detail" id="decreaseQtyDetail">-</button>
                                <input type="number" id="quantityInputDetail" value="1" min="1" readonly>
                                <button class="quantity-btn-detail" id="increaseQtyDetail">+</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-actions">
                        <button id="addToCartDetailNew" class="detail-action-btn add-to-cart">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                            <span>Sepete Ekle</span>
                        </button>
                        <button id="favoriteBtnDetail" class="detail-action-btn favorite" title="Favorilere Ekle">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                        </button>
                    </div>
                    
                    <div class="detail-trust-panel">
                        <div class="trust-item"><span>HÄ±zlÄ± Kargo</span></div>
                        <div class="trust-item"><span>GÃ¼venli Ã–deme</span></div>
                        <div class="trust-item"><span>30 GÃ¼n Ä°ade</span></div>
                    </div>
                </div>
            </div>
             <div class="reviews-section-new">
                <div class="review-form">
                    <h4>Deneyimini PaylaÅŸ</h4>
                    <div id="starRatingDetail">
                        <span data-value="1">â˜…</span><span data-value="2">â˜…</span><span data-value="3">â˜…</span><span data-value="4">â˜…</span><span data-value="5">â˜…</span>
                    </div>
                    <textarea id="reviewTextDetail" rows="3" placeholder="ÃœrÃ¼n hakkÄ±ndaki dÃ¼ÅŸÃ¼ncelerin..."></textarea>
                    <input type="file" id="reviewImageDetail" accept="image/*" />
                    <button id="submitReviewDetail">Yorumu GÃ¶nder</button>
                </div>
                <div id="reviewsListDetail">
                    <p style='color:#888;'>HenÃ¼z yorum yapÄ±lmamÄ±ÅŸ. Ä°lk yorumu sen yap!</p>
                </div>
            </div>
        </div>
        <div id="share-modal" class="modal-content" style="display: none; max-width: 450px;">
            <div class="share-modal-header">
                <h3>Bu ÃœrÃ¼nÃ¼ PaylaÅŸ</h3>
                <span class="close-btn">&times;</span>
            </div>
            <div class="share-modal-body">
                <div class="share-product-preview">

            <img id="share-product-image" src="" alt="ÃœrÃ¼n">
                    <h4 id="share-product-name">ÃœrÃ¼n AdÄ±</h4>
                </div>
                <p class="share-link-label">ÃœrÃ¼n Linkini Kopyala:</p>
                <div class="share-link-container">

         <input type="text" id="share-product-link" value="https://bedavaci.com/product/123" readonly>
                    <button id="copy-share-link-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>

                 <span>Kopyala</span>
                    </button>
                </div>
                <p class="share-social-label">Veya Sosyal Medyada PaylaÅŸ:</p>
                <div class="share-social-icons">

          <a href="#" class="social-icon whatsapp" data-social="whatsapp" title="WhatsApp">
                        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>WhatsApp</title><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91c0 1.79.46 3.48 1.32 4.95L2 22l5.25-1.38c1.41.79 3.02 1.21 4.79 1.21h.01c5.46 0 9.91-4.45 9.91-9.92 0-5.46-4.45-9.91-9.91-9.91zM12.04 20.21h-.01c-1.52 0-3-.38-4.32-1.11L3.93 20.3l1.24-3.64c-.83-1.38-1.28-2.99-1.28-4.76 0-4.54 3.7-8.24 8.24-8.24 4.54 0 8.24 3.7 8.24 8.24 0 4.54-3.7 8.24-8.24 8.24zm4.52-6.13c-.27-.13-1.59-.78-1.84-.87s-.43-.13-.61.13c-.18.27-.69.87-.85 1.04s-.32.2-.59.07c-.27-.13-1.14-.42-2.17-1.34-.81-.72-1.36-1.61-1.52-1.88s-.03-.43.12-.56c.13-.13.29-.34.43-.51s.19-.27.28-.45.05-.34-.02-.47c-.08-.13-.61-1.47-.84-2.01s-.45-.45-.61-.46c-.16 0-.34-.01-.51-.01s-.43.07-.66.34c-.23.27-.89.86-1.09 2.09s-.2 2.38.09 2.75c.29.37.91 1.48 2.22 2.61 1.31 1.13 2.33 1.5 3.16 1.75.83.25 1.59.22 2.18.13.59-.08 1.59-.65 1.81-1.28.23-.63.23-1.17.16-1.28-.07-.11-.25-.18-.51-.31z"/></svg>

                   </a>
                    <a href="#" class="social-icon twitter" data-social="twitter" title="Twitter / X">
                        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/></svg>

     </a>
                    <a href="#" class="social-icon facebook" data-social="facebook" title="Facebook">
                        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Facebook</title><path d="M22.675 0H1.325C.593 0 0 .593 0 1.325v21.351C0 23.407.593 24 1.325 24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.732 0 1.325-.593 1.325-1.325V1.325C24 .593 23.407 0 22.675 0z"/></svg>

        </a>
                    <a href="#" class="social-icon telegram" data-social="telegram" title="Telegram">
                         <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Telegram</title><path d="m9.417 15.181-.397 5.584c.568 0 .814-.244 1.109-.537l2.663-2.545 5.518 4.041c1.012.564 1.725.267 1.998-.931L23.456 3.954c.272-1.217-.433-1.706-1.22-1.393L.393 9.408c-1.218.49-1.201 1.176-.21 1.428l5.228 1.641 12.383-7.902c.576-.363 1.141-.172.679.22l-9.94 8.974z"/></svg>

  </a>
                </div>
                <div class="share-bc-notification">
                    <svg viewBox="0 0 512 512" class="bc-coin-icon"><path d="M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM256 48C141.1 48 48 141.1 48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 
48 256 48zM210.4 160C222.8 160 232.8 168.8 234.3 180.3L256 257.8L277.7 180.3C279.2 168.8 289.2 160 301.6 160H312C325.3 160 336 170.7 336 184C336 190.7 332.9 196.8 328.2 200.6L288 232L328.2 263.4C332.9 267.2 336 273.3 336 280C336 293.3 325.3 304 312 304H301.6C289.2 304 279.2 295.2 277.7 283.7L256 206.2L234.3 283.7C232.8 295.2 222.8 304 210.4 304H200C186.7 304 176 293.3 176 280C176 273.3 179.1 267.2 183.8 263.4L224 232L183.8 200.6C179.1 196.8 176 190.7 176 184C176 170.7 186.7 160 200 160H210.4z" fill="goldenrod"></path></svg>
                    <p>PaylaÅŸ & 
<strong>+15 BC</strong> Kazan!</p>

             </div>
            </div>
        </div>
    </div>
    
    <div id="treasure-hunt-banner" style="display: none;background-color: #fef8e6; text-align: center; padding: 10px; font-weight: 500; color: #8c6d00;">
        ğŸ BugÃ¼nkÃ¼ hazine sandÄ±ÄŸÄ± <strong id="treasure-clue">"Moda"</strong> kategorisinde bir yerlerde gizli! Bul ve 50 BC kazan!
    </div>
    
    <div class="modal-overlay" id="virtual-try-on-overlay" style="display: none;">
        <div class="modal-content virtual-try-on-modal">
            <span class="close-btn" id="close-vto-btn">&times;</span>
            <div class="vto-main-content">
                
<div class="vto-camera-view">

                    <video id="vto-video" autoplay muted playsinline></video>
                    <canvas id="vto-canvas"></canvas>
                </div>
                <div class="vto-controls">
                    <h3 id="vto-product-name"></h3>

                   <p><strong>Renk SeÃ§in:</strong></p>
                    <div id="vto-product-colors"></div>
                    <p class="vto-bc-notification">Bu deneme ile <strong>+5 BC</strong> kazandÄ±nÄ±z!</p>
                    <button id="vto-add-to-cart" class="add-to-cart-btn">Bu Rengi Sepete Ekle</button>

        </div>
            </div>
            <div class="vto-action-bar">
                <button id="vto-snapshot-btn">ğŸ“¸ GÃ¶rÃ¼ntÃ¼yÃ¼ Yakala</button>
                <button id="vto-share-btn">ğŸ”— PaylaÅŸ & +15 BC Kazan</button>
            </div>
        </div>
    </div>

  
    <div class="cart-overlay" id="cart-overlay"></div>
   
    <div class="cart-panel" id="cart-panel">
        <div class="cart-header"><h2>Sepetim</h2><span class="cart-close-btn" id="cart-close-btn">&times;</span></div>
        
        <div class="cart-assistant-container" id="cart-assistant-container" style="display:none;">
            <div class="assistant-header">
                <span class="assistant-icon">ğŸ’¡</span>
                <span class="assistant-title">AkÄ±llÄ± Asistan</span>

       </div>
            <div class="assistant-body" id="assistant-body">
            </div>
        </div>
        
        <div class="cart-body" id="cart-body"></div>
        <div class="cart-footer">
            <div id="free-shipping-progress" class="free-shipping-progress"></div>
            <div class="cart-summary">

           <div class="cart-summary-line"><span>Ara Toplam</span><span id="cart-subtotal">0.00 â‚º</span></div>
                <div class="cart-summary-line"><span>Kargo Ãœcreti</span><span id="cart-shipping">0.00 â‚º</span></div>
                <div class="cart-summary-line" id="cart-discount-line" style="display:none;color: var(--success-color);"><span>Ä°ndirim</span><span id="cart-discount">0.00 â‚º</span></div>
                <div class="cart-summary-line" id="cart-total"><strong>Toplam</strong><strong><span id="cart-total-price">0.00 â‚º</span></strong></div>
            </div>

 <div class="coupon-area"><input type="text" id="coupon-input" placeholder="Kupon Kodu"><button id="apply-coupon-btn">Uygula</button></div>
            <div class="trust-seals">
                <p style="font-size: 0.9em;margin-bottom: 5px;">30 gÃ¼n Ã¼cretsiz iade</p>
                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a4/Visa_Inc._logo.svg" alt="Visa">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/MasterCard_Logo.svg/1280px-MasterCard_Logo.svg.png" alt="Mastercard">
            </div>

 <div class="cart-action-buttons"><button id="checkout-btn">SatÄ±n Al</button><button id="continue-shopping-btn">AlÄ±ÅŸveriÅŸe Devam Et</button></div>
        </div>
    </div>
    
    <div id="notification-container"></div>
    
    <main>
 

       <div class="filter-container" style="display: flex; align-items: center;gap: 20px;">
            <button class="filter-btn" id="filter-btn">Filtrele</button>
            <div class="sort-container">
                <button class="filter-btn" id="sort-btn">
                    <span>SÄ±rala:</span>
                    <strong id="current-sort-display">Ã–nerilen</strong>

   </button>
                <div class="sort-panel" id="sort-panel">
                    <a href="#" class="sort-option" data-sort="default">Ã–nerilen</a>
                    <a href="#" class="sort-option" data-sort="price-asc">Fiyat: DÃ¼ÅŸÃ¼kten YÃ¼kseÄŸe</a>
                    <a href="#" class="sort-option" data-sort="price-desc">Fiyat: YÃ¼ksekten DÃ¼ÅŸÃ¼ÄŸe</a>

              <a href="#" class="sort-option" data-sort="newest">En Yeniler</a>
                </div>
            </div>
        </div>
        
        <div class="filter-panel" id="filter-panel">
            <div class="filter-panel-header">

 <h4>Filtreler</h4>
                <span class="close-filter-panel">&times;</span>
            </div>
            <div class="filter-panel-content">
                <div class="filter-section">
                    <h4>Fiyat AralÄ±ÄŸÄ±</h4>

 <div class="price-inputs">
                        <input type="number" id="min-price" placeholder="Min">
                        <span>-</span>
                        <input type="number" id="max-price" placeholder="Max">

</div>
                </div>
                <div class="filter-section">
                    <h4>Beden</h4>
                    <div class="size-selector" id="size-selector">

 <button data-size="S">S</button>
                        <button data-size="M">M</button>
                        <button data-size="L">L</button>
                        <button data-size="XL">XL</button>
                    </div>

           </div>
                <div class="filter-section">
                    <h4>Ä°ndirim</h4>
                    <div class="discount-toggle">
                        <input type="checkbox" id="on-sale-checkbox">

                   <label for="on-sale-checkbox">Ä°ndirimli ÃœrÃ¼nler</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="product-grid" id="product-grid"></div>
    </main>
    

 <div id="checkout-page" class="checkout-page" style="display: none;">
        <div id="checkout-pre-summary" class="checkout-pre-summary-container">
            <div class="pre-summary-content">
                <div class="pre-summary-header">
                    <h2>SipariÅŸ Ã–zeti</h2>
                    <a href="#" id="back-to-cart-link-pre-summary">&lt; Sepete DÃ¶n</a>
                </div>
                <div class="summary-items" id="pre-summary-items"></div>
                <div class="summary-totals" id="pre-summary-totals"></div>
                <div class="pre-summary-actions">
                    <button id="continue-shopping-from-summary-btn">AlÄ±ÅŸveriÅŸe Devam Et</button>

             <button id="proceed-to-payment-btn" class="next-btn">Ã–deme AÅŸamasÄ±na GeÃ§</button>
                </div>
            </div>
        </div>
    
        <div id="checkout-main-content" class="checkout-container" style="display: none;">
            <div class="checkout-main">
                <a href="#" 
id="back-to-store-link" style="text-decoration: none; color: #555; margin-bottom: 20px; display: inline-block;">&lt; MaÄŸazaya DÃ¶n</a>
                <div class="checkout-progress-bar">
                    <div class="progress-step-graphic" data-step="1">
                        <div class="step-circle">1</div>
                        <div class="step-label">Adres</div>

                       <div class="step-line"></div>
                    </div>
                    <div class="progress-step-graphic" data-step="2">
                        <div class="step-circle">2</div>

               <div class="step-label">Teslimat</div>
                        <div class="step-line"></div>
                    </div>
                    <div class="progress-step-graphic" data-step="3">

       <div class="step-circle">3</div>
                        <div class="step-label">Ã–deme</div>
                        <div class="step-line"></div>
                    </div>
                    <div class="progress-step-graphic" 
data-step="4">
                        <div class="step-circle">âœ“</div>
                        <div class="step-label">Onay</div>
                    </div>
                </div>


  <div id="step-1" class="checkout-step">
                    <h2 class="step-title">Teslimat Adresi</h2>
                    <form id="address-form"><div class="form-row"><div class="form-group"><label for="fname">Ä°sim</label><input type="text" id="fname" required></div><div class="form-group"><label for="lname">Soyisim</label><input type="text" id="lname" required></div></div><div class="form-group"><label for="address">Adres</label><input type="text" id="address" placeholder="Sokak, mahalle, apartman ve daire no" required></div><div class="form-row"><div class="form-group"><label for="city">Ä°l</label><input type="text" id="city" required></div><div class="form-group"><label for="zip">Posta Kodu</label><input type="text" id="zip" required></div></div><div class="form-group"><label for="phone">Telefon</label><input type="tel" id="phone" required></div><div class="form-group"><input type="checkbox" id="save-address-check"> <label for="save-address-check" style="display: inline;">Bu adresi sonraki sipariÅŸlerim iÃ§in kaydet</label></div></form>

                  <div class="step-actions"><a href="#" class="back-link" id="back-to-summary-link">&lt; SipariÅŸ Ã–zetine DÃ¶n</a><button class="next-btn" data-next="step-2">Teslimat YÃ¶ntemine GeÃ§</button></div>
                </div>

                <div id="step-2" class="checkout-step">
                    <h2 class="step-title">Teslimat YÃ¶ntemi</h2>
                    <div id="delivery-options"><label class="option-box selected"><input type="radio" name="delivery" value="standart" data-price="29.99" checked><div class="option-header"><span>Standart Kargo</span><span>29.99 â‚º</span></div><p style="font-size: 0.9em; color: #666;">Tahmini teslim: <span 
class="delivery-date-standart"></span></p></label><label class="option-box"><input type="radio" name="delivery" value="ekspres" data-price="49.99"><div class="option-header"><span>Ekspres Kargo</span><span>49.99 â‚º</span></div><p style="font-size: 0.9em; color: #666;">Tahmini teslim: <span class="delivery-date-ekspres"></span></p></label></div>
                    <div class="step-actions"><a href="#" class="back-link" data-back="step-1">&lt; Adres Bilgilerine DÃ¶n</a><button class="next-btn" data-next="step-3">Ã–deme YÃ¶ntemine GeÃ§</button></div>
                </div>

                <div id="step-3" class="checkout-step">
                    <h2 class="step-title">Ã–deme YÃ¶ntemi</h2>
                    <div id="payment-options"><label class="option-box selected"><input type="radio" name="payment" value="card" checked><span>Kredi / Banka KartÄ±</span></label><div id="card-details" style="margin-top: 15px; border: 1px solid #eee; 
padding: 15px; border-radius: 6px;"><div class="form-group"><label>Kart NumarasÄ±</label><input type="text" placeholder="---- ---- ---- ----"></div><div class="form-row"><div class="form-group"><label>Son Kullanma Tarihi</label><input type="text" placeholder="AA/YY"></div><div class="form-group"><label>CVC</label><input type="text" placeholder="---"></div></div><p style="font-size:0.8em; color: #777;">Kart bilgileriniz kesinlikle saklanmaz ve 3D Secure ile korunur.</p></div><label class="option-box"><input type="radio" name="payment" value="cod"><span>KapÄ±da Ã–deme</span></label><label class="option-box"><input type="radio" name="payment" value="eft"><span>Havale / EFT</span></label></div>
                    <div class="step-actions"><a href="#" class="back-link" data-back="step-2">&lt; Teslimat YÃ¶ntemine DÃ¶n</a><button class="next-btn" data-next="step-4">SipariÅŸi Ã–zetle</button></div>
                </div>

                <div id="step-4" class="checkout-step">
                    <h2 class="step-title">SipariÅŸ Ã–zeti ve Onay</h2>
                    <div id="summary-review"><div style="border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 15px;"><strong>Teslimat Adresi:</strong><p id="review-address"></p></div><div style="border-bottom: 1px solid #eee; padding-bottom: 
15px; margin-bottom: 15px;"><strong>Teslimat YÃ¶ntemi:</strong><p id="review-delivery"></p></div><div><strong>Ã–deme YÃ¶ntemi:</strong><p id="review-payment"></p></div></div>
                    <div class="step-actions">
                        <a href="#" class="back-link" data-back="step-3">&lt; Ã–deme YÃ¶ntemine DÃ¶n</a>
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div class="secure-payment-badge">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 
24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                                <span>GÃ¼venli Ã–deme</span>
                            </div>

   <button class="next-btn" id="confirm-order-btn" style="background: var(--success-color);">SipariÅŸi Tamamla</button>
                        </div>
                    </div>
                </div>

                <div id="order-confirmation" class="checkout-step">

      <div class="confirmation-container">
                        <div class="confirmation-icon">âœ“</div>
                        <h2 class="step-title">SipariÅŸiniz Ä°Ã§in TeÅŸekkÃ¼r Ederiz!</h2>
                        <p class="confirmation-subtext">SipariÅŸiniz baÅŸarÄ±yla alÄ±ndÄ± ve hazÄ±rlanÄ±yor. Onay e-postasÄ± tarafÄ±nÄ±za gÃ¶nderilmiÅŸtir.</p>
                        <div class="order-details-summary">
                            <div class="summary-box">
                                <strong>SipariÅŸ NumarasÄ±</strong>

                      <span id="conf-order-number"></span>
                            </div>
                            <div class="summary-box">

            <strong>Tahmini Teslimat</strong>
                                <span id="conf-delivery-date"></span>
                            </div>

  <div class="summary-box">
                                <strong>Kargo FirmasÄ±</strong>
                                <span id="conf-shipping-co"></span>
                            </div>

                         <div class="summary-box">
                                <strong>Toplam Tutar</strong>
                                <span id="conf-total-price"></span>

                    </div>
                        </div>
                        <div class="purchased-items-summary">
                            <h4>SatÄ±n AlÄ±nan ÃœrÃ¼nler</h4>

                           <div id="conf-items-list"></div>
                        </div>
                        <div class="bc-reward-summary">

     <svg viewBox="0 0 512 512" class="bc-coin-icon"><path d="M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM256 48C141.1 48 48 141.1 48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 48 256 48zM210.4 160C222.8 160 232.8 168.8 234.3 180.3L256 257.8L277.7 180.3C279.2 168.8 289.2 160 301.6 160H312C325.3 160 336 170.7 336 184C336 190.7 332.9 196.8 328.2 200.6L288 232L328.2 263.4C332.9 267.2 336 273.3 336 280C336 293.3 325.3 304 312 304H301.6C289.2 304 279.2 295.2 277.7 283.7L256 206.2L234.3 283.7C232.8 295.2 222.8 304 210.4 
304H200C186.7 304 176 293.3 176 280C176 273.3 179.1 267.2 183.8 263.4L224 232L183.8 200.6C179.1 196.8 176 190.7 176 184C176 170.7 186.7 160 200 160H210.4z" fill="goldenrod"></path></svg>
                            <p>Bu alÄ±ÅŸveriÅŸten <strong id="conf-bc-earned"></strong> kazandÄ±nÄ±z!</p>
                            <p>Toplam BC PuanÄ±nÄ±z: <strong id="conf-bc-total"></strong></p>

           </div>
                        <button id="back-to-home-final" class="next-btn" style="margin-top: 20px;">AlÄ±ÅŸveriÅŸe Devam Et</button>
                    </div>
                </div>
            </div>

 <div class="checkout-summary">
                <div class="summary-items" id="summary-items"></div>
                <div class="summary-totals" id="summary-totals"><div class="summary-line"><span>Ara Toplam</span><span id="summary-subtotal"></span></div><div class="summary-line"><span>Kargo</span><span id="summary-shipping"></span></div><div class="summary-line" id="summary-discount-line" style="display:none;"><span>Ä°ndirim</span><span id="summary-discount"></span></div><div class="summary-line gift-option"><label><input type="checkbox" id="gift-wrap-check"> Hediye paketi istiyorum (+19.99 â‚º)</label></div><div class="summary-line summary-total"><span>Toplam</span><span id="summary-total"></span></div><p class="kdv-note">KDV dahildir</p></div>
            </div>
        </div>
    </div>
    
    <footer class="site-footer">

  <p>Â© 2025 BedavacÄ±. TÃ¼m haklarÄ± saklÄ±dÄ±r.</p>
        <p>BedavacÄ± - En ucuza Ã¼rÃ¼n alma sitesi.</p>
    </footer>

    <div class="search-banner" id="search-banner">
        <button class="search-icon-btn" id="search-icon-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" 
y1="21" x2="16.65" y2="16.65"></line>
            </svg>
        </button>
        <div class="search-input-wrapper" id="search-input-wrapper">
            <input type="text" id="search-input" placeholder="ÃœrÃ¼n ara..." autocomplete="off">
            <button class="search-close-btn" id="search-close-btn">&times;</button>
            
            <div class="search-results-panel" id="search-results-panel"></div>
        </div>

 </div>
 
    <style>
        :root {
            --primary-color: red;
--secondary-color: #ff6b6b;
            --success-color: #28a745;
            --error-color: #dc3545;
            --text-color: #333;
            --light-gray: #f8f9fa;
            --checkout-blue: #007bff;
            --soft-blue: #5B86E5;
            --soft-purple: #36D1DC;
}
        * { margin: 0; padding: 0; box-sizing: border-box;
}
        body { font-family: 'Poppins', Arial, sans-serif; min-height: 100vh; position: relative; padding-bottom: 100px;
background-color: #fdfdfd; }
        body.checkout-active { overflow: hidden;
}
        header, main, footer { transition: filter 0.3s ease-in-out;
}
        body.checkout-active header, body.checkout-active main, body.checkout-active footer { filter: blur(5px); pointer-events: none;
}
        
        .top-banner { background-color: var(--primary-color);
width: 100%; padding: 15px 30px; color: white; position: fixed; top: 0; left: 0; z-index: 1000;
}
        .banner-content { display: flex; justify-content: space-between; align-items: center; gap: 30px;
}
        .left-section { display: flex; align-items: center; gap: 20px;
}
        .site-logo { height: 40px; width: 40px; fill: white;
}
        .site-name-wrapper { display: flex; align-items: center; gap: 10px; text-decoration: none; color: white;
}
        .site-name { font-family: 'Poppins', sans-serif; font-size: 2.2em; font-weight: 700;
}
        .right-section { display: flex; align-items: center; gap: 20px;
}
        .auth-button { padding: 10px 20px; font-size: 1em; cursor: pointer; background-color: white;
color: var(--primary-color); border: 1px solid white; border-radius: 5px; transition: background-color 0.3s;
}
        .cart-section { font-size: 1.1em; cursor: pointer;
}
        .categories-menu { position: relative;
}
        .categories-icon { cursor: pointer; width: 28px; height: 28px; display: flex; align-items: center;
justify-content: center; }
        .categories-icon svg { width: 100%; height: 100%; fill: white;
}
        .categories-dropdown { display: none; position: absolute; top: 40px; left: 0; background-color: white;
color: black; border-radius: 5px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); overflow: hidden; width: 200px; z-index: 1001;
}
        .categories-dropdown a { display: block; padding: 12px 15px; text-decoration: none; color: #333;
transition: background-color 0.2s; cursor: pointer; }
        .categories-dropdown a:hover { background-color: #f5f5f5;
}

        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%;
height: 100%; background-color: rgba(0, 0, 0, 0.6); z-index: 2000; justify-content: center; align-items: center; animation: fadeIn 0.3s ease;
}
        .modal-content { background-color: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 400px;
box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative; animation: slideIn 0.4s ease-out;
}
        .modal-content h2 { margin-bottom: 20px; text-align: center;
}
        .close-btn { position: absolute; top: 15px; right: 15px; font-size: 24px; font-weight: bold;
cursor: pointer; color: #333; z-index: 10; }
        .modal-content-bc { background: linear-gradient(135deg, #2980b9, #8e44ad);
}
        .modal-content-bc h2#bc-modal-title { color: black;
}
        .modal-content-bc p#bc-modal-amount { color: white; font-weight: 700; font-size: 3.5em; text-align: center;
margin-top: 15px; }
        .modal-content-bc .close-btn { color: white;
}
        .form-group { margin-bottom: 15px;
}
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500;
}
        .form-group input, .form-group select { width: 100%; padding: 12px;
border: 1px solid #ccc; border-radius: 6px; font-size: 1em; }
        .modal-btn { width: 100%;
padding: 12px; background-color: var(--primary-color); color: white; border: none; border-radius: 5px; font-size: 1.1em; cursor: pointer; transition: background-color 0.3s;
}
        .switch-form-link { text-align: center; margin-top: 15px;
}
        .switch-form-link a { color: var(--primary-color); cursor: pointer; text-decoration: none;
}
        .profile-info p { margin-bottom: 12px; font-size: 1.1em;
}
        .profile-info strong { display: inline-block; width: 120px; color: #555;
}
        .divider { display: flex; align-items: center; text-align: center; color: #aaa;
margin: 20px 0; }
        .divider::before, .divider::after { content: ''; flex: 1;
border-bottom: 1px solid #eee; }
        .divider:not(:empty)::before { margin-right: .5em;
}
        .divider:not(:empty)::after { margin-left: .5em;
}
        .social-login-container { display: flex; flex-direction: column; gap: 10px;
}
        .social-btn { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%;
padding: 12px; border-radius: 5px; border: 1px solid #ddd; font-size: 1em; font-weight: 500; cursor: pointer; transition: all 0.2s ease-in-out;
}
        .social-btn svg { width: 20px; height: 20px;
}
        .social-btn:active { transform: scale(0.98); box-shadow: 0 1px 2px rgba(0,0,0,0.1) inset;
}
        .google-btn { background-color: #fff; color: #444;
}
        .google-btn:hover { background-color: #f8f8f8;
}
        .apple-btn { background-color: #000; color: #fff;
}
        .apple-btn:hover { background-color: #222;
}
        .microsoft-btn { background-color: #fff; color: #5e5e5e;
}
        .microsoft-btn:hover { background-color: #f8f8f8;
}
        .notification { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
padding: 15px 25px; border-radius: 8px; color: white; font-weight: 500; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 3000;
animation: slideUp 0.5s ease-out forwards; }
        .notification.success { background-color: var(--success-color);
}
        .notification.error { background-color: var(--error-color);
}
        main { padding-top: 100px; padding-bottom: 180px; max-width: 1200px; margin: 0 auto;
padding-left: 20px; padding-right: 20px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px; }
        .product-card { border: 1px solid #eee; border-radius: 10px; padding: 15px;
text-align: center; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.2s ease, box-shadow 0.2s ease; position: relative;
}
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
        .product-card img { max-width: 100%; height: 150px; object-fit: contain; margin-bottom: 10px;
}
        .product-card h3 { font-size: 1.2em; margin-bottom: 5px;
}
        .product-card .price { font-size: 1.1em; font-weight: bold; color: var(--primary-color); margin-bottom: 10px;
}
        .product-card .discount { font-size: 0.9em; text-decoration: line-through; color: #999; margin-right: 5px;
}
        .add-to-cart-btn { background-color: var(--success-color); color: white; border: none; padding: 10px 20px;
border-radius: 5px; cursor: pointer; transition: opacity 0.3s; }
        .vto-trigger-btn { background-color: var(--soft-purple);
margin-top: 5px; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: opacity 0.3s;
}
        .filter-container { margin-bottom: 25px; position: relative;
}
        .filter-btn { padding: 10px 20px; font-size: 1em; background-color: #f8f9fa;
border: 1px solid #ddd; border-radius: 8px; cursor: pointer; font-weight: 500;
}
        .filter-panel { background-color: #fff; border: 1px solid #eee;
box-shadow: 0 6px 12px rgba(0,0,0,0.1); border-radius: 8px; padding: 20px; margin-top: 10px; max-height: 0; overflow: hidden;
transition: max-height 0.5s ease-out, padding 0.5s ease-out; }
        .filter-panel.open { max-height: 500px;
padding: 20px; }
        .filter-section { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #f0f0f0;
}
        .filter-section:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0;
}
        .filter-section h4 { margin-bottom: 15px; font-weight: 600;
}
        .price-inputs, .size-selector { display: flex; gap: 10px; align-items: center;
}
        .price-inputs label { font-size: 0.9em;
}
        .price-inputs input { width: 80px; padding: 8px; border: 1px solid #ccc;
border-radius: 5px; text-align: center; }
        .size-selector button { width: 40px; height: 40px;
border-radius: 50%; border: 1px solid #ccc; background-color: #fff; cursor: pointer; transition: all 0.2s;
}
        .size-selector button.selected { background-color: var(--text-color); color: white; border-color: var(--text-color);
}
        .discount-toggle { display: flex; align-items: center; gap: 10px;
}
        .discount-toggle label { cursor: pointer;
}
        #on-sale-checkbox { width: 20px; height: 20px;
}
        .cart-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%;
height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1050; }
        .cart-panel { position: fixed;
top: 0; right: -100%; width: 100%; max-width: 420px; height: 100%; background-color: white; z-index: 1100; transition: right 0.4s ease-in-out; display: flex;
flex-direction: column; }
        .cart-panel.open { right: 0;
}
        
        .cart-assistant-container { padding: 15px 20px;
background: linear-gradient(135deg, #e9f5ff, #fdf4f4); border-bottom: 1px solid #eee; animation: fadeIn 0.5s ease;
}
        .assistant-header { display: flex; align-items: center; gap: 8px; font-weight: 600; color: #0056b3;
margin-bottom: 12px; }
        .assistant-icon { font-size: 1.5em;
}
        .assistant-offer { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(5px); padding: 12px;
border-radius: 8px; margin-bottom: 10px; border: 1px solid #dde8f0; }
        .assistant-offer p { margin: 0 0 10px 0;
font-size: 0.95em; line-height: 1.4; }
        .suggestion-product { display: flex; align-items: center; gap: 10px;
}
        .suggestion-product img { width: 50px; height: 50px; object-fit: contain; background-color: white;
border-radius: 6px; border: 1px solid #eee; }
        .suggestion-product-info { flex-grow: 1;
}
        .suggestion-product-info strong { display: block;
}
        .suggestion-product-info span { font-size: 0.9em; color: var(--primary-color); font-weight: 500;
}
        .suggestion-product button { font-size: 0.9em; padding: 6px 12px; white-space: nowrap;
}
        
        .cart-header { display: flex;
justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid #eee;
}
        .cart-header h2 { font-size: 1.5em;
}
        .cart-close-btn { font-size: 2em; cursor: pointer; color: #888;
}
        
        .cart-body { flex-grow: 1;
flex-basis: 0; overflow-y: auto; padding: 10px 20px; }
        .cart-empty-message { text-align: center;
padding: 50px 20px; color: #777; }
        .cart-item { display: flex; gap: 15px;
padding: 15px 0; border-bottom: 1px solid #f0f0f0; }
        .cart-item-img { width: 80px;
height: 80px; object-fit: contain; border: 1px solid #eee; border-radius: 5px;
}
        .cart-item-details { flex-grow: 1; display: flex; flex-direction: column;
}
        .cart-item-title { font-weight: 600; margin-bottom: 5px;
}
        .cart-item-attributes { font-size: 0.9em; color: #666; margin-bottom: 5px;
}
        .cart-item-price { font-weight: bold; color: var(--primary-color); margin-top: auto;
}
        .cart-item-actions { display: flex; flex-direction: column; justify-content: space-between; align-items: center;
}
        .quantity-control { display: flex; align-items: center; border: 1px solid #ccc; border-radius: 5px;
}
        .quantity-btn { width: 30px; height: 30px; border: none; background: none; font-size: 1.5em;
cursor: pointer; }
        .item-quantity { width: 30px; text-align: center; font-size: 1.1em;
}
        .remove-item-btn { background: none; border: none; color: #aaa; cursor: pointer; font-size: 1.2em;
}
        .cart-footer { padding: 20px; border-top: 1px solid #eee; background-color: var(--light-gray);
box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .cart-summary-line { display: flex; justify-content: space-between;
margin-bottom: 10px; font-size: 1em; }
        #cart-total { font-size: 1.3em; font-weight: bold;
}
        .coupon-area { display: flex; gap: 10px; margin: 15px 0;
}
        #coupon-input { flex-grow: 1; padding: 8px; border: 1px solid #ccc; border-radius: 5px;
}
        #apply-coupon-btn { padding: 8px 15px; border: none; background-color: #555; color: white;
border-radius: 5px; cursor: pointer; }
        .free-shipping-progress { text-align: center; padding: 10px; background-color: #e9f5ff;
color: #0056b3; border-radius: 5px; margin-bottom: 15px; font-size: 0.9em; }
        .trust-seals { text-align: center;
margin: 15px 0; }
        .trust-seals img { height: 25px; margin: 0 5px;
opacity: 0.7; }
        .cart-action-buttons { display: flex; flex-direction: column; gap: 10px;
}
        .cart-action-buttons button { padding: 15px; font-size: 1.1em; border-radius: 5px; border: none;
cursor: pointer; }
        #checkout-btn { background-color: var(--secondary-color); color: white;
}
        #continue-shopping-btn { background-color: #ddd; color: #333;
}
        .checkout-page { position: fixed; top: 0; left: 0; width: 100%; height: 100%;
background-color: #f0f2f5; z-index: 1200; animation: fadeIn 0.5s ease; overflow-y: auto;
}
        .checkout-container { display: grid; grid-template-columns: 60% 40%; width: 100%; max-width: 1400px;
margin: 0 auto; min-height: 100%; }
        .checkout-main { padding: 40px 50px; background-color: white;
}
        .checkout-summary { padding: 40px 30px; background-color: #f8f9fa; border-left: 1px solid #ddd;
display: flex; flex-direction: column; position: sticky; top: 0; height: 100vh;
}
        .checkout-progress-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; font-size: 0.9em;
}
        .progress-step-graphic { display: flex; flex-direction: column; align-items: center; position: relative; flex-grow: 1;
}
        .progress-step-graphic .step-circle { width: 30px; height: 30px; border-radius: 50%; background-color: #e0e0e0;
border: 2px solid #e0e0e0; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; transition: all 0.4s ease; z-index: 2;
}
        .progress-step-graphic .step-label { margin-top: 8px; color: #aaa; transition: color 0.4s ease;
}
        .progress-step-graphic.active .step-circle { background-color: var(--soft-blue); border-color: var(--soft-blue);
}
        .progress-step-graphic.active .step-label { color: var(--soft-blue); font-weight: bold;
}
        .progress-step-graphic:not(:last-child)::before { content: ''; position: absolute; top: 15px; left: 50%; width: 100%;
height: 2px; background-color: #e0e0e0; z-index: 1; transition: background-color 0.4s ease;
}
        .progress-step-graphic.active:not(:last-child)::before { background-color: var(--soft-blue);
}
        .checkout-step { display: none;
}
        .checkout-step.active { display: block; animation: fadeIn 0.5s;
}
        .step-title { font-size: 2em; margin-bottom: 25px; color: var(--text-color);
}
        .form-row { display: flex; gap: 20px;
}
        .checkout-page .form-group input { padding: 15px; border-radius: 8px; border: 1px solid #ddd;
transition: all 0.3s ease; }
        .checkout-page .form-group input:focus { border-color: var(--soft-blue); outline: none;
box-shadow: 0 0 0 3px rgba(91, 134, 229, 0.2); }
        .checkout-page .option-box { border: 2px solid #eee;
border-radius: 8px; padding: 15px; margin-bottom: 10px; cursor: pointer; transition: all 0.3s ease;
}
        .checkout-page .option-box:hover { border-color: var(--soft-purple);
}
        .checkout-page .option-box.selected { border-color: var(--soft-blue);
box-shadow: 0 4px 8px rgba(91, 134, 229, 0.15); transform: translateY(-2px);
}
        .option-box input[type="radio"] { display: none;
}
        .option-header { display: flex; justify-content: space-between; font-weight: bold;
}
        .step-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 30px;
border-top: 1px solid #eee; padding-top: 20px; }
        .back-link { color: var(--soft-blue); text-decoration: none;
font-size: 0.9em; font-weight: 500;}
        .next-btn { background: linear-gradient(to right, var(--soft-purple), var(--soft-blue)); color: white;
padding: 16px 32px; border: none; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s ease;
box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .next-btn:hover { transform: translateY(-2px);
box-shadow: 0 6px 15px rgba(0,0,0,0.15); }
        .next-btn:active { transform: translateY(0);
box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .summary-items { flex-grow: 1; overflow-y: auto;
margin-bottom: 20px; }
        .summary-item { display: flex; align-items: center; gap: 15px; margin-bottom: 15px;
}
        .summary-item-img { width: 60px; height: 60px; object-fit: contain; border-radius: 6px; background-color: white;
}
        .summary-item-info { flex-grow: 1;
}
        .summary-item-info div { font-weight: 500;
}
        .summary-item-info span { font-size: 0.9em; color: #666;
}
        .summary-item-price { font-weight: 500;
}
        .summary-totals { border-top: 1px solid #ddd; padding-top: 15px;
}
        .summary-line { display: flex; justify-content: space-between; margin-bottom: 8px;
}
        .summary-total { font-size: 1.5em; font-weight: bold; margin-top: 10px;
}
        .kdv-note { font-size: 0.8em; color: #777; text-align: right;
}
        .gift-option { margin-top: 20px; padding: 15px; background-color: #e9ecef; border-radius: 6px;
}
        .site-footer { background-color: #111; color: white; text-align: center; padding: 20px; position: absolute;
bottom: 0; width: 100%; }
        .search-banner { position: fixed; bottom: 65px; left: 50%;
transform: translateX(-50%); width: auto; background: linear-gradient(90deg, rgba(255,0,0,1) 0%, rgba(255,200,0,1) 100%); z-index: 998; border-radius: 50px; padding: 8px;
box-shadow: 0 4px 15px rgba(0,0,0,0.2); display: flex; align-items: center; transition: all 0.4s ease;
}
        .search-banner.search-active { width: 90%; max-width: 500px;
}
        .search-icon-btn { background: none; border: none; cursor: pointer; padding: 5px; display: flex;
align-items: center; justify-content: center; }
        .search-icon-btn svg { width: 30px; height: 30px;
stroke: white; stroke-width: 2.5; }
        .search-input-wrapper { display: none; width: 100%; align-items: center;
}
        .search-banner.search-active .search-input-wrapper { display: flex;
}
        .search-banner.search-active .search-icon-btn { display: none;
}
        #search-input { width: 100%; border: none; background: none; outline: none; color: white;
font-size: 1.1em; padding: 5px 15px; font-family: 'Poppins', sans-serif; }
        #search-input::placeholder { color: rgba(255,255,255,0.8);
}
        .search-close-btn { background: none; border: none; color: white; font-size: 2.2em; cursor: pointer;
padding: 0 10px; font-weight: 300; }
        @keyframes fadeIn { from { opacity: 0;
} to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-30px);
opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideUp { from { bottom: -100px;
opacity: 0; } to { bottom: 20px; opacity: 1; } }
        .filter-btn { display: inline-flex;
align-items: center; gap: 8px; background: linear-gradient(135deg, var(--soft-blue), var(--soft-purple)); color: white; border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
transition: all 0.3s ease; font-weight: 600; }
        .filter-btn:hover { transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(0,0,0,0.2); }
        .filter-btn::before { content: 'â§±'; font-size: 1.2em;
}
        .filter-panel { padding: 0 20px;
}
        .filter-panel.open { padding: 20px;
}
        #orders-list-container, #favorites-list-container { max-height: 60vh; overflow-y: auto; padding-right: 10px;
}
        .order-item { background-color: #f9f9f9; border: 1px solid #eee; border-left: 5px solid var(--soft-blue);
border-radius: 8px; padding: 20px; margin-bottom: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; align-items: center;
}
        .order-info span { display: block; font-size: 0.85em; color: #777;
}
        .order-info strong { font-size: 1.1em; color: #333;
}
        .order-status { padding: 6px 12px; border-radius: 20px; font-weight: 600; font-size: 0.9em;
text-align: center; }
        .status-HazÄ±rlanÄ±yor { background-color: #fff0c2; color: #8c6d00;
}
        .status-Kargoda { background-color: #c2eaff; color: #005a8c;
}
        .status-Teslim\.Edildi { background-color: #d4edda; color: #155724;
}
        .track-cargo-btn { background-color: var(--text-color); color: white; border: none; padding: 10px 15px;
border-radius: 6px; cursor: pointer; transition: background-color 0.2s; font-weight: 500; white-space: nowrap;
}
        .track-cargo-btn:hover { background-color: #555;
}
        .tracking-timeline { position: relative; padding: 20px 0;
}
        .tracking-timeline::before { content: ''; position: absolute; top: 0; left: 15px; height: 100%;
width: 3px; background-color: #e0e0e0; }
        .timeline-item { position: relative; padding-left: 50px; margin-bottom: 25px;
}
        .timeline-item:last-child { margin-bottom: 0;
}
        .timeline-item::before { content: ''; position: absolute; left: 5px; top: 5px; width: 22px;
height: 22px; border-radius: 50%; background-color: #e0e0e0; border: 3px solid white; z-index: 1;
}
        .timeline-item.completed::before { background-color: var(--success-color);
}
        .timeline-item-content strong { display: block; font-weight: 600; color: #333;
}
        .timeline-item-content span { font-size: 0.9em; color: #777;
}
        .confirmation-container { display: flex; flex-direction: column; align-items: center; text-align: center;
}
        .confirmation-icon { font-size: 4em; color: white; background-color: var(--success-color); width: 100px; height: 100px;
border-radius: 50%; display: flex; align-items: center; justify-content: center; line-height: 1; margin-bottom: 20px;
}
        .confirmation-subtext { max-width: 500px; color: #666; margin-bottom: 30px;
}
        .order-details-summary { display: flex; gap: 20px; background-color: #f8f9fa; padding: 20px; border-radius: 12px;
margin-bottom: 30px; width: 100%; justify-content: space-around; flex-wrap: wrap; }
        .summary-box { text-align: center;
}
        .summary-box strong { display: block; font-size: 0.9em; color: #555; margin-bottom: 5px;
}
        .summary-box span { font-size: 1.2em; font-weight: 600;
}
        .purchased-items-summary { width: 100%; max-width: 600px; text-align: left; margin-bottom: 30px;
border: 1px solid #eee; border-radius: 8px; padding: 20px; }
        .purchased-items-summary h4 { margin-bottom: 15px;
}
        .conf-item { display: flex; align-items: center; gap: 15px; padding-bottom: 10px; margin-bottom: 10px;
border-bottom: 1px solid #f5f5f5; }
        .conf-item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0;
}
        .conf-item-img { width: 50px; height: 50px; object-fit: contain; border-radius: 6px;
}
        .bc-reward-summary { background: linear-gradient(135deg, #fef8e6, #fce9c5); border-radius: 12px; padding: 20px; display: flex;
flex-direction: column; align-items: center; gap: 10px; }
        .bc-reward-summary p { margin: 0;
font-size: 1.1em; color: #8c6d00; }
        .bc-coin-icon { width: 40px; height: 40px;
}
        .checkout-pre-summary-container { width: 100%; min-height: 100%; display: flex; align-items: center; justify-content: center;
padding: 20px; }
        .pre-summary-content { width: 100%; max-width: 600px; background-color: white; border-radius: 12px;
box-shadow: 0 8px 30px rgba(0,0,0,0.1); padding: 30px; animation: fadeIn 0.4s ease;
}
        .pre-summary-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee;
padding-bottom: 15px; margin-bottom: 20px; }
        .pre-summary-header h2 { font-size: 1.8em; color: var(--text-color);
}
        .pre-summary-header a { font-size: 0.9em; color: var(--soft-blue); text-decoration: none; font-weight: 500;
}
        #pre-summary-items { max-height: 40vh; overflow-y: auto; padding-right: 10px;
}
        #pre-summary-totals { border-top: 1px solid #ddd; padding-top: 20px; margin-top: 20px;
}
        .pre-summary-actions { display: flex; justify-content: space-between; gap: 15px; margin-top: 30px;
}
        .pre-summary-actions button { width: 100%; padding: 16px; font-size: 1.1em; border-radius: 8px;
border: none; cursor: pointer; font-weight: 600; }
        #continue-shopping-from-summary-btn { background-color: #f0f0f0; color: #333;
border: 1px solid #ddd; }

        /* =================================================================== */
        /* --- YENÄ° VE GELÄ°ÅTÄ°RÄ°LMÄ°Å ÃœRÃœN DETAY MODALI STÄ°LLERÄ° --- */
        /* =================================================================== */

        .detail-modal-layout-new {
            display: flex;
            width: 100%;
            height: 100%;
        }
        .detail-gallery {
            flex: 1;
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #f8f9fa;
        }
        .detail-main-image-wrapper {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
        }
        #detailMainImage {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }
         #detailMainImage:hover {
            transform: scale(1.1);
        }
        .detail-thumbnail-wrapper {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .detail-thumbnail {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: border-color 0.2s;
            background-color: white;
        }
        .detail-thumbnail:hover {
            border-color: #999;
        }
        .detail-thumbnail.selected {
            border-color: var(--soft-blue);
        }
        .detail-info {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        #detailNameNew {
            font-size: 2em;
            font-weight: 700;
            color: var(--text-color);
            margin: 0 0 10px 0;
            line-height: 1.2;
        }
        .detail-meta {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #777;
            font-size: 0.9em;
        }
        .detail-stars {
            color: #fdd835;
            font-size: 1.2em;
        }
        .detail-separator {
            color: #ccc;
        }
        .stock-status {
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.8em;
        }
        .stock-status.in-stock {
            color: #155724;
            background-color: #d4edda;
        }
        .stock-status.low-stock {
            color: #856404;
            background-color: #fff3cd;
        }
        .stock-status.out-of-stock {
            color: #721c24;
            background-color: #f8d7da;
        }
        .detail-price-new {
            display: flex;
            align-items: baseline;
            gap: 15px;
            margin-bottom: 15px;
        }
        #detailPriceNew {
            font-size: 2.2em;
            font-weight: bold;
            color: var(--primary-color);
        }
        #detailDiscountNew {
            font-size: 1.3em;
            color: #888;
            text-decoration: line-through;
        }
        .detail-description {
            font-size: 1em;
            color: #555;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .detail-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }
        .option-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .option-group label {
            font-weight: 600;
            width: 60px;
        }
        .color-selector {
            display: flex;
            gap: 8px;
        }
        .color-swatch {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 0 0 1px #ccc;
            transition: all 0.2s;
        }
        .color-swatch:hover {
            transform: scale(1.1);
        }
        .color-swatch.selected {
            box-shadow: 0 0 0 2px var(--soft-blue);
        }
        .size-selector-detail {
            display: flex;
            gap: 8px;
        }
        .size-selector-detail button {
            min-width: 40px;
            height: 40px;
            padding: 0 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            background-color: #fff;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }
        .size-selector-detail button.selected {
            background-color: var(--text-color);
            color: white;
            border-color: var(--text-color);
        }
        .quantity-control-detail {
            display: flex;
            align-items: center;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        .quantity-btn-detail {
            width: 40px;
            height: 40px;
            border: none;
            background: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #555;
        }
        #quantityInputDetail {
            width: 50px;
            height: 40px;
            text-align: center;
            font-size: 1.1em;
            border: none;
            border-left: 1px solid #ccc;
            border-right: 1px solid #ccc;
            -moz-appearance: textfield;
        }
        #quantityInputDetail::-webkit-outer-spin-button,
        #quantityInputDetail::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .detail-actions {
            display: flex;
            gap: 15px;
            margin-top: auto; /* Pushes to the bottom */
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .detail-action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .detail-action-btn.add-to-cart {
            flex-grow: 1;
            background: linear-gradient(to right, var(--success-color), #208f3a);
            color: white;
        }
        .detail-action-btn.favorite {
            flex-shrink: 0;
            width: 55px;
            background-color: #f0f0f0;
            color: #555;
        }
        .detail-action-btn.favorite.favorited {
             background-color: #f8d7da;
             color: var(--error-color);
        }
        .detail-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .detail-trust-panel {
            display: none; /* Åimdilik gizli, isterseniz aktif edebiliriz */
        }
        .reviews-section-new {
            display: none; /* Åimdilik gizli, isterseniz aktif edebiliriz */
        }
        
        /* =================================================== */
        /* --- YENÄ° VE GELÄ°ÅTÄ°RÄ°LMÄ°Å PROFÄ°L MENÃœSÃœ STÄ°LLERÄ° --- */
        /* =================================================== */
        .profile-icon-wrapper { 
            position: relative;
cursor: pointer; 
            color: white;
}
        .profile-icon-wrapper svg { 
            stroke: white;
fill: white;
}

        @keyframes profileMenuFadeIn {
            from {
                opacity: 0;
transform: translateY(-10px) scale(0.95);
            }
            to {
                opacity: 1;
transform: translateY(0) scale(1);
            }
        }

        .profile-menu {
            display: none;
position: absolute;
            top: 140%; 
            right: 0;
width: 360px; 
            background-color: white;
            color: var(--text-color);
border-radius: 12px; 
            box-shadow: 0 10px 35px rgba(0,0,0,0.1), 0 3px 10px rgba(0,0,0,0.05);
border: 1px solid #e9e9e9;
            z-index: 1002;
            overflow: hidden;
            transform-origin: top right;
}
        .profile-menu.open {
            display: block;
animation: profileMenuFadeIn 0.3s ease-out forwards;
        }

        .profile-menu-header {
            display: flex;
align-items: center;
            gap: 15px;
            padding: 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
}
        .profile-menu-header.simple {
            flex-direction: column;
align-items: flex-start;
            gap: 8px;
        }
        .profile-avatar {
            width: 50px;
height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--soft-blue), var(--soft-purple));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: 600;
flex-shrink: 0;
        }
        .profile-user-info strong {
            display: block;
font-size: 1.1em;
            font-weight: 600;
        }
        .profile-user-info span {
            font-size: 0.9em;
color: #777;
        }
        .profile-menu-header h4 {
            margin: 0;
font-size: 1.1em;
        }
        .profile-menu-header p {
            margin: 0;
font-size: 0.9em;
            color: #666;
        }

        .profile-menu-actions {
            padding: 10px 20px 20px 20px;
}
        .profile-menu-btn {
            display: block;
width: 100%;
            margin-top: 10px;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            background: #fff;
            font-weight: 600;
            cursor: pointer;
            font-size: 1em;
text-align: center;
            transition: all 0.2s ease;
        }
        .profile-menu-btn:hover {
            transform: translateY(-1px);
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .profile-menu-btn.primary {
            background-color: var(--primary-color);
color: white;
            border-color: var(--primary-color);
        }
        
        .profile-bc-summary {
            display: flex;
align-items: center;
            gap: 12px;
            padding: 15px 20px;
            background-color: #fef8e6;
            border-bottom: 1px solid #eee;
}
        .profile-bc-summary .bc-coin-icon {
            width: 28px;
height: 28px;
            flex-shrink: 0;
        }
        .profile-bc-summary span {
            flex-grow: 1;
font-size: 0.95em;
            color: #8c6d00;
            font-weight: 500;
        }
        .profile-bc-summary strong {
            font-size: 1.2em;
color: #8c6d00;
            font-weight: 700;
        }

        .profile-menu-links {
            display: grid;
grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 20px;
        }
        .profile-menu-item {
            display: flex;
align-items: center;
            gap: 12px;
            padding: 12px 10px;
            text-decoration: none;
            color: #444;
            border-radius: 8px;
            transition: background-color 0.2s ease, color 0.2s ease;
opacity: 0;
            transform: translateY(10px);
        }

        .profile-menu.open .profile-menu-item {
            animation: menuItemFadeIn 0.4s ease-out forwards;
}
        .profile-menu.open .link-column:nth-child(1) .profile-menu-item:nth-child(1) { animation-delay: 0.1s;
}
        .profile-menu.open .link-column:nth-child(2) .profile-menu-item:nth-child(1) { animation-delay: 0.15s;
}
        .profile-menu.open .link-column:nth-child(1) .profile-menu-item:nth-child(2) { animation-delay: 0.2s;
}
        .profile-menu.open .link-column:nth-child(2) .profile-menu-item:nth-child(2) { animation-delay: 0.25s;
}
        .profile-menu.open .link-column:nth-child(1) .profile-menu-item:nth-child(3) { animation-delay: 0.3s;
}
        .profile-menu.open .link-column:nth-child(2) .profile-menu-item:nth-child(3) { animation-delay: 0.35s;
}
        .profile-menu.open .profile-menu-footer .profile-menu-item { animation-delay: 0.4s;
}

        @keyframes menuItemFadeIn {
            to {
                opacity: 1;
transform: translateY(0);
            }
        }
        
        .profile-menu-item:hover {
            background-color: var(--soft-blue);
color: white;
        }
        .profile-menu-item svg {
            width: 20px;
height: 20px;
            flex-shrink: 0;
            stroke: currentColor;
        }

        .profile-menu-footer {
            padding: 0 20px 15px 20px;
border-top: 1px solid #eee;
            margin-top: 5px;
            padding-top: 15px;
        }
        #menu-logout-btn:hover {
            background-color: var(--error-color);
color: white;
        }
        
        .modal-content.enhanced { display: flex;
padding: 0; max-width: 800px; width: 95%; overflow: hidden;
}
        .modal-art-side { flex: 1;
background-size: cover; background-position: center; padding: 40px; color: white;
display: flex; flex-direction: column; justify-content: flex-end;
}
        .modal-art-side h3 { font-size: 2.5em;
line-height: 1.2; text-shadow: 0 2px 5px rgba(0,0,0,0.5);
}
        .modal-art-side p { font-size: 1.1em;
text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}
        .modal-form-side { flex: 1; padding: 30px;
position: relative; background-color: white;
}
        .cart-section { display: flex; align-items: center; gap: 8px;
background-color: rgba(255, 255, 255, 0.15); padding: 8px 15px; border-radius: 50px; text-decoration: none; color: white; transition: background-color 0.3s ease;
}
        .cart-section:hover { background-color: rgba(255, 255, 255, 0.25);
}
        .cart-icon-wrapper { position: relative;
}
        .cart-section svg { stroke: white;
}
        .cart-item-count { position: absolute; top: -5px; right: -8px; background-color: var(--secondary-color); color: white;
width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75em; font-weight: 700; border: 2px solid var(--primary-color);
transform: scale(0); transition: transform 0.2s ease-out; }
        .cart-item-count.visible { transform: scale(1);
}
        .cart-text { font-weight: 500; font-size: 1em;
}
        @keyframes cart-pop { 0% { transform: scale(1); } 50% { transform: scale(1.2);
} 100% { transform: scale(1); } }
        .cart-icon-wrapper.pop { animation: cart-pop 0.3s ease-in-out;
}
        .search-results-panel { display: none; position: absolute; bottom: calc(100% + 10px); left: 0;
width: 100%; background-color: white; border-radius: 8px; box-shadow: 0 8px 25px rgba(0,0,0,0.15); max-height: 40vh; overflow-y: auto; z-index: -1;
}
        .search-result-item { display: flex; align-items: center; gap: 15px; padding: 10px 15px;
text-decoration: none; color: #333; border-bottom: 1px solid #f0f0f0; transition: background-color 0.2s; cursor: pointer;
}
        .search-result-item:last-child { border-bottom: none;
}
        .search-result-item:hover { background-color: #f8f9fa;
}
        .search-result-img { width: 50px; height: 50px; object-fit: contain;
}
        .search-result-name { font-weight: 500;
}
        .no-results-message { padding: 20px; text-align: center; color: #888;
}
        .delete-review-btn { position: absolute; top: 10px; right: 10px; background: none; border: none;
font-size: 1.2em; cursor: pointer; color: #aaa; transition: color 0.2s; }
        .delete-review-btn:hover { color: var(--error-color);
}
        #share-modal .close-btn { top: 10px; right: 10px;
}
        .share-modal-header { text-align: center; padding: 0 10px 15px 10px;
border-bottom: 1px solid #eee; margin-bottom: 20px; }
        .share-modal-header h3 { font-size: 1.6em;
font-weight: 600; color: var(--text-color); margin: 0; }
        .share-modal-body { padding: 0 10px 10px 10px;
}
        .share-product-preview { display: flex; align-items: center; gap: 15px; background-color: #f8f9fa; padding: 15px;
border-radius: 8px; margin-bottom: 20px; }
        .share-product-preview img { width: 60px; height: 60px;
object-fit: contain; border-radius: 6px; }
        .share-product-preview h4 { margin: 0; font-size: 1.1em;
font-weight: 500; flex-grow: 1; }
        .share-link-label, .share-social-label { font-size: 0.9em; font-weight: 500;
color: #555; margin-bottom: 8px; }
        .share-link-container { display: flex; margin-bottom: 20px;
}
        .share-link-container input { flex-grow: 1; border: 1px solid #ccc; padding: 0 12px;
font-size: 0.9em; background-color: #f5f5f5; color: #333; border-radius: 6px 0 0 6px; outline: none;
}
        .share-link-container button { border: none; background-color: var(--soft-blue); color: white; padding: 10px 12px;
cursor: pointer; border-radius: 0 6px 6px 0; display: flex; align-items: center; gap: 6px; transition: background-color 0.2s;
}
        .share-link-container button:hover { background-color: #4a75d6;
}
        .share-link-container button svg { width: 16px; height: 16px; stroke: white;
}
        .share-social-icons { display: flex; justify-content: center; gap: 15px; margin-bottom: 20px;
}
        .social-icon { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center;
justify-content: center; transition: all 0.3s ease; }
        .social-icon:hover { transform: translateY(-5px) scale(1.1);
box-shadow: 0 6px 15px rgba(0,0,0,0.15); }
        .social-icon svg { width: 24px; height: 24px;
fill: white; }
        .social-icon.whatsapp { background-color: #25D366;
}
        .social-icon.twitter { background-color: #14171A;
}
        .social-icon.facebook { background-color: #1877F2;
}
        .social-icon.telegram { background-color: #2AABEE;
}
        .share-bc-notification { margin-top: 15px; background: linear-gradient(135deg, #fef8e6, #fce9c5); border-radius: 8px; padding: 10px;
display: flex; align-items: center; justify-content: center; gap: 10px; }
        .share-bc-notification p { margin: 0;
font-size: 1em; color: #8c6d00; font-weight: 500; }
        
        .modal-header-enhanced {
            display: flex;
justify-content: space-between;
            align-items: center;
            padding: 0 30px 20px 30px;
            margin: -30px -30px 20px -30px;
            border-bottom: 1px solid #eee;
            background-color: #f8f9fa;
}
        .modal-header-enhanced h2 {
            margin: 0;
}
        .modal-header-btn {
            padding: 8px 16px;
font-size: 0.9em;
            font-weight: 600;
            background-color: var(--soft-blue);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
}
        .modal-header-btn:hover {
            background-color: #4a75d6;
}
        .enhanced-list-container {
            max-height: 65vh;
overflow-y: auto;
            padding: 5px;
        }
        
        .modal-content-profile {
            padding: 0;
}
        .profile-modal-header {
            padding: 30px;
background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
            border-radius: 10px 10px 0 0;
}
        .profile-modal-header h2 {
            text-align: left;
margin: 0 0 5px 0;
        }
        .profile-modal-header p {
            margin: 0;
text-align: left;
            color: #666;
        }
        .profile-modal-body {
            padding: 25px;
}
        .profile-tabs {
            display: flex;
border-bottom: 1px solid #ddd;
            margin-bottom: 25px;
        }
        .profile-tab-link {
            padding: 10px 20px;
border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            margin-bottom: -1px;
transition: all 0.2s ease;
        }
        .profile-tab-link:hover {
            color: #333;
background-color: #f5f5f5;
        }
        .profile-tab-link.active {
            color: var(--soft-blue);
border-bottom-color: var(--soft-blue);
        }
        .profile-tab-content {
            display: none;
}
        .profile-tab-content.active {
            display: block;
animation: fadeIn 0.4s;
        }
        .profile-overview-grid {
            display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .overview-card {
            background-color: #f8f9fa;
padding: 20px;
            border-radius: 8px;
            border: 1px solid #eee;
        }
        .overview-card h4 {
            margin: 0 0 15px 0;
font-size: 1.1em;
        }
        .overview-card p {
            margin: 0 0 5px 0;
font-size: 0.9em;
        }
        .overview-card strong {
            font-size: 1.4em;
color: var(--text-color);
        }
        .address-list .address-card {
            padding: 15px;
border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 15px;
            position: relative;
}
        .address-list .address-card p {
            margin: 0;
}
        .address-actions {
            position: absolute;
top: 10px;
            right: 10px;
        }
        .address-actions button {
            background: none;
border: none; cursor: pointer; font-size: 1.1em; margin-left: 5px;
        }

        .enhanced-order-item, .enhanced-favorite-item {
            display: flex;
align-items: center;
            gap: 20px;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
}
        .enhanced-order-item:last-child, .enhanced-favorite-item:last-child {
            border-bottom: none;
}
        .enhanced-item-img {
            width: 80px;
height: 80px;
            object-fit: contain;
            border-radius: 8px;
            background-color: #f8f9fa;
            flex-shrink: 0;
}
        .enhanced-item-details {
            flex-grow: 1;
}
        .enhanced-item-details h4 {
            margin: 0 0 5px 0;
font-weight: 600;
        }
        .enhanced-item-details p {
            margin: 0;
font-size: 0.9em;
            color: #666;
        }
        .enhanced-item-actions {
            display: flex;
align-items: center;
            gap: 10px;
        }
        
        .coupon-tabs {
            display: flex;
background-color: #f1f1f1;
            border-radius: 8px;
            padding: 5px;
            margin-bottom: 20px;
        }
        .coupon-tab-link {
            flex: 1;
padding: 10px;
            border: none;
            background: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
}
        .coupon-tab-link.active {
            background-color: white;
color: var(--soft-blue);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .coupon-tab-content {
            display: none;
}
        .coupon-tab-content.active {
            display: block;
}
        .coupon-card {
            display: flex;
align-items: center;
            border: 1px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            background-color: #fdfdfd;
}
        .coupon-card.expired {
            opacity: 0.6;
background-color: #f5f5f5;
        }
        .coupon-icon {
            font-size: 2em;
margin-right: 20px;
            color: var(--soft-blue);
        }
        .coupon-details p {
            margin: 0;
font-size: 0.9em;
            color: #666;
        }
        .coupon-details strong {
            font-size: 1.1em;
color: #333;
        }
        
        #settings-modal .modal-content h2 {
            text-align: left;
}
        .settings-container {
            display: flex;
gap: 30px;
            margin-top: 20px;
        }
        .settings-sidebar {
            flex-basis: 200px;
flex-shrink: 0;
            border-right: 1px solid #eee;
        }
        .settings-menu-item {
            display: block;
padding: 12px 15px;
            text-decoration: none;
            color: #555;
            font-weight: 500;
            border-radius: 6px;
            margin-right: -1px;
            border-right: 3px solid transparent;
transition: all 0.2s ease;
        }
        .settings-menu-item:hover {
            background-color: #f5f5f5;
}
        .settings-menu-item.active {
            background-color: #e9f2ff;
color: var(--soft-blue);
            border-right-color: var(--soft-blue);
        }
        .settings-content {
            flex-grow: 1;
}
        .setting-pane {
            display: none;
}
        .setting-pane.active {
            display: block;
animation: fadeIn 0.4s;
        }
        .setting-pane h4 {
            margin: 0 0 5px 0;
}
        .setting-pane p {
            margin: 0 0 20px 0;
color: #666;
        }
        .setting-option {
            display: flex;
justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
}
        .toggle-switch {
            position: relative;
display: inline-block;
            width: 50px;
            height: 28px;
            background-color: #ccc;
            border-radius: 28px;
            transition: background-color 0.3s;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
}
        .toggle-switch::before {
            content: '';
position: absolute;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background-color: white;
            top: 3px;
            left: 4px;
            transition: transform 0.3s;
}
        .toggle-switch:checked {
            background-color: var(--success-color);
}
        .toggle-switch:checked::before {
            transform: translateX(21px);
}

        .accordion {
            border: 1px solid #eee;
border-radius: 8px;
            overflow: hidden;
        }
        .accordion-item {
            border-bottom: 1px solid #eee;
}
        .accordion-item:last-child {
            border-bottom: none;
}
        .accordion-header {
            width: 100%;
padding: 15px 20px;
            text-align: left;
            background-color: #f8f9fa;
            border: none;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s;
}
        .accordion-header:hover {
            background-color: #f1f1f1;
}
        .accordion-header::after {
            content: '+';
position: absolute;
            right: 20px;
            font-size: 1.4em;
            color: #888;
            transition: transform 0.3s ease;
}
        .accordion-header.active::after {
            transform: rotate(45deg);
}
        .accordion-content {
            max-height: 0;
overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            background-color: white;
}
        .accordion-content p {
            padding: 20px;
margin: 0;
            line-height: 1.6;
        }
        .contact-support {
            margin-top: 30px;
text-align: center;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }
        .contact-support h4 {
            margin: 0 0 10px 0;
}
        .contact-support .contact-btn {
            margin: 5px;
padding: 10px 20px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: white;
            cursor: pointer;
}
        
        @media (max-width: 992px) {
            .checkout-container { grid-template-columns: 1fr;
}
            .checkout-summary { grid-row: 1; position: static; height: auto;
border-left: none; border-bottom: 1px solid #ddd; }
            .checkout-main { padding: 30px 20px 80px 20px;
}
            .checkout-page .next-btn { position: fixed; bottom: 0;
left: 0; width: 100%; border-radius: 0; z-index: 1; padding: 20px;
}
            .vto-main-content { flex-direction: column;
}
        }
        @media (max-width: 768px) {
            .modal-art-side { display: none;
}
            .modal-form-side { flex: auto;
}
            .modal-content.enhanced { flex-direction: column; max-width: 400px;
}
            .cart-footer { position: sticky; bottom: 0;
}
            .top-banner { padding: 12px 15px;
}
            .banner-content { gap: 10px;
}
            .site-name-wrapper { gap: 5px;
}
            .site-logo { height: 30px; width: 30px;
}
            .site-name { font-size: 1.6em;
}
            .left-section, .right-section { gap: 10px;
}
            .auth-button { padding: 8px 10px; font-size: 0.9em;
}
            .cart-section { font-size: 1em;
}

             /* YENÄ°: ÃœrÃ¼n Detay ModalÄ± mobil uyumu */
            .detail-modal-layout-new {
                flex-direction: column;
                height: auto;
            }
            #productDetailModal {
                max-width: 95vw !important;
                max-height: 90vh;
                overflow-y: auto;
            }
            .detail-info {
                padding: 20px;
            }
            .detail-gallery {
                padding: 15px;
            }

            .cart-text { display: none;
}
            .cart-section { padding: 8px; background-color: transparent;
}
        }
        @media (max-width: 420px) {
            .site-name { font-size: 1.3em;
}
            .auth-button { padding: 6px 8px;
}
            .cart-section span { font-size: 0.9em;
}
            .left-section, .right-section { gap: 8px;
}
             .profile-menu {
                width: 95vw;
max-width: 360px;
                /* YENÄ°: MOBÄ°LDE ORTALAMA KODU */
                left: 50%;
                transform: translateX(-50%);
                right: auto;
            }
        }
       
       @media (max-width: 768px) {
            .filter-panel { position: fixed;
bottom: 0; left: 0; width: 100%; height: 85vh; max-height: 100vh; background-color: white; z-index: 1150; border-top-left-radius: 20px; border-top-right-radius: 20px;
box-shadow: 0 -5px 20px rgba(0,0,0,0.15); transform: translateY(100%); transition: transform 0.4s ease-in-out; display: flex; flex-direction: column;
}
            .filter-panel.open { transform: translateY(0);
}
            .filter-panel-content { flex-grow: 1; overflow-y: auto;
padding: 0 25px 25px 25px; }
            .filter-panel-header { display: flex;
justify-content: space-between; align-items: center; padding: 20px 25px; border-bottom: 1px solid #eee; position: sticky; top: 0; background-color: white;
}
            .filter-panel-header h4 { font-size: 1.4em;
}
            .close-filter-panel { font-size: 2.2em; color: #888; cursor: pointer;
font-weight: 300; }
        }
        @media (max-width: 768px) {
            .profile-menu-links {
    grid-template-columns: 1fr;
                gap: 5px;
            }

            #profile-modal, 
            #orders-modal, 
            #favorites-modal, 
            #coupons-modal, 
            #settings-modal, 
     #help-modal {
                width: 95vw;
max-width: 95vw; 
                padding: 20px;

                max-height: 85vh;

                overflow-y: auto;

            }

            .settings-container {
                flex-direction: column;

                gap: 20px;
}
            
            .settings-sidebar {
                flex-basis: auto;

                border-right: none;

                border-bottom: 1px solid #eee;

                padding-bottom: 15px;
display: flex;
                overflow-x: auto;
            }
            
            .settings-menu-item {
                border-right: none;
border-bottom: 3px solid transparent; 
                margin-right: 15px;
white-space: nowrap; 
            }

            .settings-menu-item.active {
                border-right-color: transparent;
border-bottom-color: var(--soft-blue);
            }
        }
    </style>
    
    <script>
document.addEventListener('DOMContentLoaded', () => {

    // ========================================================================================= //
    // --- ELEMENT TANIMLAMALARI (GÃœVENLÄ°K KONTROLLERÄ° EKLENDÄ°) ---
    // ========================================================================================= //
    const profileIconWrapper = document.getElementById('profile-icon-wrapper');
    const profileMenu = document.getElementById('profile-menu');
    const loggedOutMenu = document.getElementById('profile-menu-logged-out');
    const loggedInMenu = document.getElementById('profile-menu-logged-in');
    const modalOverlay = document.getElementById('modal-overlay');
    const loginModal = document.getElementById('login-modal');
    const registerModal = document.getElementById('register-modal');

 const profileModal = document.getElementById('profile-modal');
    const bcModal = document.getElementById('bc-modal');
    const ordersModal = document.getElementById('orders-modal');
const trackingModal = document.getElementById('tracking-modal');
    const favoritesModal = document.getElementById('favorites-modal');
    const productDetailModal = document.getElementById('productDetailModal');
    const shareModal = document.getElementById('share-modal');

    const couponsModal = document.getElementById('coupons-modal');
    const settingsModal = document.getElementById('settings-modal');
    const helpModal = document.getElementById('help-modal');

    const cartOpenBtn = document.getElementById('cart-open-btn');
    const cartPanel = document.getElementById('cart-panel');
    const cartOverlay = document.getElementById('cart-overlay');
    const cartBody = document.getElementById('cart-body');
    const checkoutPage = document.getElementById('checkout-page');

    const categoriesIcon = document.getElementById('categories-icon');
    const categoriesDropdown = document.getElementById('categories-dropdown');
    const productGrid = document.getElementById('product-grid');
    const searchBanner = document.getElementById('search-banner');
    const searchInput = document.getElementById('search-input');

    const filterBtn = document.getElementById('filter-btn');
    const filterPanel = document.getElementById('filter-panel');
    const sortBtn = document.getElementById('sort-btn');
    const sortPanel = document.getElementById('sort-panel');

    // YENÄ°LENMÄ°Å ÃœrÃ¼n Detay Modal Elementleri
    const detailMainImage = document.getElementById('detailMainImage');
    const detailThumbnails = document.getElementById('detailThumbnails');
    const detailNameNew = document.getElementById('detailNameNew');
    const detailRatingStars = document.getElementById('detailRatingStars');
    const detailReviewCount = document.getElementById('detailReviewCount');
    const detailStockStatus = document.getElementById('detailStockStatus');
    const detailPriceNew = document.getElementById('detailPriceNew');
    const detailDiscountNew = document.getElementById('detailDiscountNew');
    const detailDescription = document.getElementById('detailDescription');
    const detailColorsContainer = document.getElementById('detailColorsContainer');
    const detailColorSelector = document.getElementById('detailColorSelector');
    const detailSizesContainer = document.getElementById('detailSizesContainer');
    const detailSizeSelector = document.getElementById('detailSizeSelector');
    const quantityInputDetail = document.getElementById('quantityInputDetail');
    const addToCartDetailNew = document.getElementById('addToCartDetailNew');
    const favoriteBtnDetail = document.getElementById('favoriteBtnDetail');

    const starRatingContainer = document.getElementById('starRatingDetail');

    const starRatingDetail = starRatingContainer ? starRatingContainer.querySelectorAll('span') : [];

    const reviewTextDetail = document.getElementById('reviewTextDetail');
    const reviewImageDetail = document.getElementById('reviewImageDetail');
    const submitReviewDetail = document.getElementById('submitReviewDetail');
    const reviewsListDetail = document.getElementById('reviewsListDetail');

    const vtoOverlay = document.getElementById('virtual-try-on-overlay');
    const vtoCloseBtn = document.getElementById('close-vto-btn');

    const vtoVideo = document.getElementById('vto-video');
    const vtoCanvas = document.getElementById('vto-canvas');
    const vtoProductName = document.getElementById('vto-product-name');
    const vtoProductColors = document.getElementById('vto-product-colors');
    const vtoAddToCartBtn = document.getElementById('vto-add-to-cart');

    let faceMeshModel = null;
    let vtoIsRunning = false;
    let vtoAnimationId = null;

    let currentVTOProduct = null;
    let currentVTOColor = null;
    let videoStream = null;

    let currentDetailProductId = null;
    let currentShareProductId = null;
    let detailRating = 0;

    let treasureProductId = null;

    // ========================================================================================= //
    // --- Ã–RNEK VERÄ°TABANI (KUPONLAR) ---
    // ========================================================================================= //
     const couponsDB = [
        { id: 1, code: 'BEDAVA10', description: 'TÃ¼m Ã¼rÃ¼nlerde %10 indirim', status: 'active', expiry: '2025-12-31' },
        { id: 2, code: 'YAZ2025', description: 'Moda kategorisinde 500 TL Ã¼zerine 100 TL indirim', status: 'active', expiry: '2025-09-01' },
        { id: 3, code: 'TECH5', description: 'Teknoloji Ã¼rÃ¼nlerinde %5 indirim', status: 'expired', expiry: '2025-03-01' }

    ];

    // ========================================================================================= //
    // --- ÃœRÃœN VERÄ°TABANI ---
    // ========================================================================================= //
    const productsDB = [
        { 
            id: 1, name: 'AkÄ±llÄ± Telefon', price: 35000, img: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-pro-finish-select-202309-6-1inch-naturaltitanium?wid=5120&hei=2880&fmt=p-jpg&qlt=80&.v=1692845699492', 
            images: [
                'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-pro-finish-select-202309-6-1inch-naturaltitanium?wid=5120&hei=2880&fmt=p-jpg&qlt=80&.v=1692845699492',
                'https://www.apple.com/newsroom/images/2023/09/apple-debuts-iphone-15-and-iphone-15-plus/article/Apple-iPhone-15-lineup-hero-230912_inline.jpg.large.jpg',
                'https://www.apple.com/v/iphone-15-pro/c/images/overview/closer-look/all_colors__d42651ac5qqe_large.jpg'
            ],
            attributes: 'Model: Pro, Renk: Titanyum', stock: 5, category: 'teknoloji', onSale: true, discountPrice: 32500,
            related_products: [
                { id: 2, text: 'MÃ¼ziÄŸin keyfini Ã§Ä±karÄ±n' },
                { id: 3, text: 'Telefonunuzu bileÄŸinizde taÅŸÄ±yÄ±n' }
            ]
        },
        { id: 2, name: 'Kablosuz KulaklÄ±k', price: 4500, img: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/MME73?wid=1144&hei=1144&fmt=jpeg&qlt=90&.v=1632861342000', attributes: 'Renk: Beyaz', stock: 10, category: 'teknoloji', onSale: false },
        { id: 3, name: 'AkÄ±llÄ± Saat', price: 12000, img: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/apple-watch-ultra-2-witb-202309?wid=1364&hei=932&fmt=jpeg&qlt=90&.v=1692737943449', attributes: 'Model: Spor, Kordon: Mavi', stock: 3, category: 'teknoloji', onSale: false },
        { 
            id: 4, name: 'Siyah T-Shirt', price: 500, img: 'https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?w=500&auto=format&fit=crop&q=60', attributes: 'KumaÅŸ: Pamuk', stock: 25, category: 'moda', onSale: true, discountPrice: 425, sizes: ['S', 'M', 'L'],
            bundle_offer: {
                name: "Casual Kombin",
                partner_ids: [5, 8],

             discount_percentage: 10,
                text: "Bu kombini tamamlayarak %10 indirim kazanÄ±n!"
}
        },
        { 
            id: 5, name: 'Jean Pantolon', price: 1200, img: 'https://images.unsplash.com/photo-1602293589914-9FF0554d1b0d?w=500&auto=format&fit=crop&q=60', attributes: 'Model: Slim Fit', stock: 15, category: 'moda', onSale: false, sizes: ['M', 'L', 'XL'],
            bundle_offer: { name: "Casual Kombin", partner_ids: [4, 8], discount_percentage: 10, text: "Bu kombini tamamlayarak %10 indirim kazanÄ±n!"}
        },
        { 
            id: 6, name: 'Ruj', price: 850, img: 'https://images.unsplash.com/photo-1585386959984-a4155224a1ad?w=500&auto=format&fit=crop&q=60', attributes: 'KalÄ±cÄ± & Mat', stock: 8, category: 'kozmetik', onSale: false, colors: [ { name: 'Tutkulu KÄ±rmÄ±zÄ±', hex: '#C70039' }, { name: 'Åeker Pembe', hex: '#F96167' }, { name: 'Nude', hex: '#E2B6A1' }, { name: 'Bordo', hex: '#800020' } ]
        },
        { id: 7, name: 'Kahve Makinesi', price: 3200, img: 'https://images.unsplash.com/photo-1565452344049-52c2da239c93?w=500&auto=format&fit=crop&q=60', attributes: 'Tip: Filtre', stock: 6, category: 'ev-yasam', onSale: true, discountPrice: 2999 },
        { 
            id: 8, name: 'Beyaz Sneaker', price: 2800, img: 'https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=500&auto=format&fit=crop&q=60', attributes: 'Malzeme: Deri', stock: 12, category: 'moda', onSale: false, sizes: ['M', 'L'],
            bundle_offer: { name: "Casual Kombin", partner_ids: [4, 5], discount_percentage: 10, text: "Bu kombini tamamlayarak %10 indirim kazanÄ±n!"}
        },
    ];

    let cart = JSON.parse(sessionStorage.getItem('cart')) || [];

    let coupon = null;
    let currentFilters = { category: 'all', minPrice: '', maxPrice: '', sizes: [], onSale: false };

    let currentSort = 'default';
    const checkoutState = { address: null, delivery: { type: 'standart', price: 29.99 }, payment: 'card', giftWrap: false };

    // ========================================================================================= //
    // --- MERKEZÄ° VERÄ° YÃ–NETÄ°MÄ° VE YARDIMCI FONKSÄ°YONLAR ---
    // ========================================================================================= //
    const getUserDatabase = () => JSON.parse(localStorage.getItem('users')) || [];
    const saveUserDatabase = (users) => localStorage.setItem('users', JSON.stringify(users));
    const getActiveUser = () => JSON.parse(sessionStorage.getItem('currentUser'));

    const setActiveUser = (user) => sessionStorage.setItem('currentUser', JSON.stringify(user));
    const logoutUser = () => sessionStorage.removeItem('currentUser');

    const updateActiveUser = (updatedUser) => {
        const users = getUserDatabase();

        const currentUser = getActiveUser();
        if (!currentUser) return;
        const userIndex = users.findIndex(u => u.email === currentUser.email);

        if (userIndex > -1) {
            users[userIndex] = updatedUser;
            saveUserDatabase(users);

            setActiveUser(updatedUser);
        }
    };
    const showNotification = (message, type) => {
        const container = document.getElementById('notification-container');

        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.textContent = message;
        container.appendChild(notification);
        setTimeout(() => notification.remove(), 3000);
    };

    const validateUsername = (username) => /^[a-zA-Z0-9]{4,}$/.test(username);
    const validateEmail = (email) => /^\S+@\S+\.\S+$/.test(email);
    const validatePhone = (phone) => /^(05\d{9})$/.test(phone);

    const validatePassword = (password) => /^[a-zA-Z0-9\p{P}\p{S}]{6,}$/u.test(password);

    // ========================================================================================= //
    // --- MODAL YÃ–NETÄ°MÄ° ---
    // ========================================================================================= //
    const openModal = (modalElement) => {
        if (!modalElement) return;

        modalOverlay.style.display = 'flex';
        modalOverlay.querySelectorAll('.modal-content').forEach(modal => modal.style.display = 'none');
        modalElement.style.display = modalElement.id === 'productDetailModal' ? 'block' : (modalElement.classList.contains('enhanced') || modalElement.classList.contains('modal-content-profile') ? 'flex' : 'block');
    };

    const closeModal = () => {
        modalOverlay.style.display = 'none';
    };

    // ========================================================================================= //
    // --- CANLI ARAMA FONKSÄ°YONU ---
    // ========================================================================================= //
    const showLiveSearchResults = () => {
        const resultsPanel = document.getElementById('search-results-panel');

        const searchTerm = searchInput.value.toLowerCase().trim();

        if (searchTerm.length < 2) {
            resultsPanel.style.display = 'none';

            return;
        }

        const filtered = productsDB.filter(p => p.name.toLowerCase().includes(searchTerm)).slice(0, 5);

        if (filtered.length > 0) {
            resultsPanel.innerHTML = filtered.map(product => `
                <div class="search-result-item" data-product-id="${product.id}">
                    <img src="${product.img}" alt="${product.name}" class="search-result-img">
                    <span class="search-result-name">${product.name}</span>
                </div>

          `).join('');

        } else {
            resultsPanel.innerHTML = `<div class="no-results-message">SonuÃ§ bulunamadÄ±.</div>`;

        }
        resultsPanel.style.display = 'block';
    };

    // ========================================================================================= //
    // --- PAYLAÅMA MODALI FONKSÄ°YONLARI ---
    // ========================================================================================= //
    const openShareModal = (product) => {
        currentShareProductId = product.id;

        const shareImage = document.getElementById('share-product-image');
        const shareName = document.getElementById('share-product-name');
        const shareLink = document.getElementById('share-product-link');
        
        shareImage.src = product.img;
        shareName.textContent = product.name;

        shareLink.value = `https://bedavaci.com/product/${product.id}`;

        openModal(shareModal);
    };
    const claimShareReward = () => {
        const user = getActiveUser();

        if (!user) {
            showNotification('BC PuanÄ± kazanmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z.', 'error');

            openModal(loginModal);
            return;
        }

        const lastSharedKey = `lastShared_${currentShareProductId}`;
        const lastSharedTime = sessionStorage.getItem(lastSharedKey);

        if (lastSharedTime) {
            showNotification('Bu Ã¼rÃ¼n iÃ§in paylaÅŸÄ±m Ã¶dÃ¼lÃ¼nÃ¼ zaten aldÄ±nÄ±z.', 'success');

            return;
        }

        user.bc = (user.bc || 0) + 15;
        updateActiveUser(user);
        updateUI();

        showNotification('PaylaÅŸÄ±mÄ±nÄ±z iÃ§in teÅŸekkÃ¼rler! +15 BC kazandÄ±nÄ±z!', 'success');
        sessionStorage.setItem(lastSharedKey, Date.now());
    };

    // ========================================================================================= //
    // --- FAVORÄ°LER FONKSÄ°YONLARI ---
    // ========================================================================================= //
    const toggleFavorite = (productId) => {
        const user = getActiveUser();

        if (!user) {
            showNotification('Favorilere eklemek iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z.', 'error');

            openModal(loginModal);
            return;
        }
        user.favorites = user.favorites || [];
        const productIndex = user.favorites.indexOf(productId);

        if (productIndex > -1) {
            user.favorites.splice(productIndex, 1);

            showNotification('ÃœrÃ¼n favorilerden Ã§Ä±karÄ±ldÄ±.', 'success');
        } else {
            user.favorites.push(productId);

            showNotification('ÃœrÃ¼n favorilere eklendi!', 'success');
        }
        updateActiveUser(user);
        updateFavoriteIcons();
    };

    const updateFavoriteIcons = () => {
        const user = getActiveUser();

        document.querySelectorAll('.favorite-btn, #favoriteBtnDetail').forEach(btn => {
            const productId = parseInt(btn.dataset.productId);
            if (user && user.favorites && user.favorites.includes(productId)) {
                btn.classList.add('favorited');
                if(btn.id === 'favoriteBtnDetail') btn.title = "Favorilerden Ã‡Ä±kar";
            } else {
                btn.classList.remove('favorited');
                 if(btn.id === 'favoriteBtnDetail') btn.title = "Favorilere Ekle";
            }
        });
    };

    // ========================================================================================= //
    // --- YENÄ°LENMÄ°Å & YENÄ° MODAL Ä°Ã‡ERÄ°K FONKSÄ°YONLARI ---
    // ========================================================================================= //
    const renderProfileModal = () => {
        const user = getActiveUser();

        if (!user) return;
        const overviewContainer = document.getElementById('profile-overview');

        const totalOrders = user.orders ? user.orders.length : 0;
        const totalSpent = user.orders ? user.orders.reduce((sum, order) => sum + order.total, 0) : 0;
        overviewContainer.innerHTML = `
            <div class="profile-overview-grid">
                <div class="overview-card"><h4>Toplam SipariÅŸ</h4><p>BugÃ¼ne kadar verdiÄŸiniz sipariÅŸ sayÄ±sÄ±.</p><strong>${totalOrders}</strong></div>
                <div class="overview-card"><h4>Toplam Harcama</h4><p>Sitemizde yaptÄ±ÄŸÄ±nÄ±z toplam harcama.</p><strong>${totalSpent.toFixed(2)} â‚º</strong></div>
                <div class="overview-card"><h4>BC PuanlarÄ±</h4><p>Mevcut sadakat puanlarÄ±nÄ±z.</p><strong>${user.bc || 0} BC</strong></div>
            </div>`;

        const profileEditForm = document.getElementById('profile-edit-form');

        profileEditForm.innerHTML = `
            <div class="form-row">
                <div class="form-group"><label for="edit-name">Ä°sim</label><input type="text" id="edit-name" value="${user.name}" required></div>
                <div class="form-group"><label for="edit-surname">Soyisim</label><input type="text" id="edit-surname" value="${user.surname}" required></div>
            </div>
            <div class="form-group"><label for="edit-username">KullanÄ±cÄ± AdÄ±</label><input type="text" id="edit-username" value="${user.username}" required></div>

            <div class="form-group"><label for="edit-email">E-posta</label><input type="email" id="edit-email" value="${user.email}" required></div>
            <div class="form-group"><label for="edit-phone">Telefon</label><input type="tel" id="edit-phone" value="${user.phone}" required></div>
            <div class="form-group"><label for="edit-password">Yeni Åifre (deÄŸiÅŸtirmek iÃ§in doldurun)</label><input type="password" id="edit-password"></div>
            <button type="submit" class="modal-btn">DeÄŸiÅŸiklikleri Kaydet</button>`;

        const addressesContainer = document.getElementById('profile-addresses');

        addressesContainer.innerHTML = `
            <div class="address-list">
                <div class="address-card">
                    <strong>Ev Adresi</strong>
                    <p>${user.address ? user.address.address : 'Sokak, mahalle, no...'}</p>
                    <p>${user.address ? user.address.city : 'Ä°l'}</p>
                    <div class="address-actions"><button>âœï¸</button><button>ğŸ—‘ï¸</button></div>
                </div>
            </div>
            <button class="modal-btn" style="background-color: #6c757d; margin-top: 15px;">Yeni Adres Ekle</button>`;

    };
    
    const renderOrders = (statusFilter = 'all') => {
        const user = getActiveUser();

        const container = document.getElementById('orders-list-container');
        if (!user) {
             showNotification('SipariÅŸleri gÃ¶rmek iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z.', 'error');

             return;
        }
        if (!user.orders || user.orders.length === 0) {
            container.innerHTML = `<div class="cart-empty-message"><h3>HenÃ¼z sipariÅŸiniz yok.</h3><p>AlÄ±ÅŸveriÅŸe baÅŸlayarak harika fÄ±rsatlarÄ± yakalayÄ±n!</p></div>`;

            return;
        }

        const filteredOrders = statusFilter === 'all' ? user.orders : user.orders.filter(order => order.status === statusFilter);

        container.innerHTML = filteredOrders.slice().reverse().map(order => {
             const firstProduct = productsDB.find(p => p.id === order.items[0].productId);
             return `
            <div class="enhanced-order-item">
                <img src="${firstProduct.img}" alt="${firstProduct.name}" class="enhanced-item-img">
                <div class="enhanced-item-details">

                    <h4>SipariÅŸ #${order.id}</h4>
                    <p>Tarih: ${new Date(order.date).toLocaleDateString('tr-TR')} | Tutar: <strong>${order.total.toFixed(2)} â‚º</strong></p>
                    <p>Durum: <span class="order-status status-${order.status.replace(' ','_')}">${order.status}</span></p>
                </div>
                <div class="enhanced-item-actions">

                    <button class="track-cargo-btn" data-order-id="${order.id}">Kargo Takip</button>
                </div>
            </div>`;
        }).join('');

    };
    
    const renderFavorites = () => {
        const user = getActiveUser();

        const container = document.getElementById('favorites-list-container');
        if (!user || !user.favorites || user.favorites.length === 0) {
            container.innerHTML = `<div class="cart-empty-message"><h3>Favori Ã¼rÃ¼nÃ¼nÃ¼z yok.</h3><p>Bir Ã¼rÃ¼nÃ¼ favorilerinize eklemek iÃ§in kalp ikonuna tÄ±klayÄ±n.</p></div>`;

            return;
        }
        const favoriteProducts = user.favorites.map(id => productsDB.find(p => p.id === id)).filter(p => p);

        container.innerHTML = favoriteProducts.map(product => {
            const priceHTML = product.onSale ? `<span class="discount">${product.price.toFixed(2)} â‚º</span>${product.discountPrice.toFixed(2)} â‚º` : `${product.price.toFixed(2)} â‚º`;
            return `
            <div class="enhanced-favorite-item">
                 <img src="${product.img}" alt="${product.name}" class="enhanced-item-img">
                 <div class="enhanced-item-details">

                    <h4>${product.name}</h4>
                    <p class="cart-item-price">${priceHTML}</p>
                 </div>
                 <div class="enhanced-item-actions">
                    <button class="add-to-cart-btn" data-product-id="${product.id}">Sepete Ekle</button>

                </div>
            </div>`;
        }).join('');

    };

    const renderCoupons = () => {
        const activeContainer = document.getElementById('active-coupons');

        const expiredContainer = document.getElementById('expired-coupons');

        activeContainer.innerHTML = couponsDB.filter(c => c.status === 'active').map(coupon => `
            <div class="coupon-card">
                <div class="coupon-icon">ğŸŸï¸</div>
                <div class="coupon-details">
                    <strong>${coupon.code}</strong>
                    <p>${coupon.description}</p>

                   <p>Son GeÃ§erlilik: ${coupon.expiry}</p>
                </div>
            </div>
        `).join('');

        expiredContainer.innerHTML = couponsDB.filter(c => c.status === 'expired').map(coupon => `
            <div class="coupon-card expired">
                <div class="coupon-icon">ğŸŸï¸</div>
                <div class="coupon-details">
                    <strong>${coupon.code}</strong>
                    <p>${coupon.description}</p>

             </div>
            </div>
        `).join('');

    };

    const renderTrackingInfo = (order) => {
        document.getElementById('tracking-modal-title').textContent = `Kargo Takip #${order.id}`;

        const timelineContainer = document.getElementById('tracking-timeline-container');
        const statuses = [
            { stage: 'SipariÅŸ AlÄ±ndÄ±', date: new Date(order.date).toLocaleString('tr-TR'), completed: true },
            { stage: 'Ã–deme OnaylandÄ±', date: new Date(order.date + 1000*60*5).toLocaleString('tr-TR'), completed: true },
            { stage: 'SipariÅŸ HazÄ±rlanÄ±yor', date: new Date(order.date + 1000*60*60*3).toLocaleString('tr-TR'), completed: ['Kargoda', 'Teslim Edildi'].includes(order.status) },
            { stage: 'Kargoya Verildi', date: new Date(order.date + 1000*60*60*24).toLocaleString('tr-TR'), completed: order.status === 'Teslim Edildi' },
            { stage: 'Teslim Edildi', date: new Date(order.date + 1000*60*60*24*3).toLocaleString('tr-TR'), completed: order.status === 'Teslim Edildi' },
        ];

        timelineContainer.innerHTML = statuses.map(s => `
            <div class="timeline-item ${s.completed ? 'completed' : ''}">
                <div class="timeline-item-content">
                    <strong>${s.stage}</strong>
                    <span>${s.completed ? s.date : 'Bekleniyor...'}</span>
                </div>

           </div>
        `).join('');

    };

    // ========================================================================================= //
    // --- ÃœRÃœN & FÄ°LTRELEME FONKSÄ°YONLARI ---
    // ========================================================================================= //
    const renderProducts = (productsToRender) => {
        if (!productGrid) return;

        const currentUser = getActiveUser();
        const today = new Date().toDateString();
        productGrid.innerHTML = productsToRender.map(product => {
            const priceHTML = product.onSale
                ? `<span class="discount">${product.price.toFixed(2)} â‚º</span>${product.discountPrice.toFixed(2)} â‚º`
                : `${product.price.toFixed(2)} â‚º`;

            const vtoButtonHTML = product.category === 'kozmetik' && product.colors

 ? `<button class="vto-trigger-btn" data-product-id="${product.id}">âœ¨ Sanal Dene</button>`
                : '';

            let treasureHTML = '';
            if (currentUser && currentUser.lastTreasureClaimDate !== today && product.id === treasureProductId) {
                treasureHTML = `<div class="treasure-chest" title="Hazineyi buldun!">ğŸ</div>`;
            }

           let lowStockHTML = '';
            if (product.stock <= 5 && product.stock > 0) {
                lowStockHTML = `<div class="low-stock-warning">Son ${product.stock} Ã¼rÃ¼n!</div>`;
            }
            
            return `

    <div class="product-card" data-product-id="${product.id}">
                ${treasureHTML}
                ${lowStockHTML}
                
                <div class="product-card-actions">
                    <button class="favorite-btn" data-product-id="${product.id}" title="Favorilere Ekle">â™¡</button>

               <button class="share-btn" data-product-id="${product.id}" title="PaylaÅŸ">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3z"></path></svg>

               </button>
                </div>
                
                <img src="${product.img}" alt="${product.name}" style="cursor: pointer;" class="product-image-for-detail">
                
                <h3>${product.name}</h3>

                <div class="price">${priceHTML}</div>
                <button class="add-to-cart-btn" data-product-id="${product.id}">Sepete Ekle</button>
                ${vtoButtonHTML}
            </div>`;

        }).join('');
        updateFavoriteIcons();
    };
    const applyAllFilters = () => {
        let filtered = [...productsDB];

        if (currentFilters.category !== 'all') filtered = filtered.filter(p => p.category === currentFilters.category);
        if (currentFilters.onSale) filtered = filtered.filter(p => p.onSale);

        const min = parseFloat(currentFilters.minPrice);
        const max = parseFloat(currentFilters.maxPrice);
        if (!isNaN(min)) filtered = filtered.filter(p => (p.onSale ? p.discountPrice : p.price) >= min);

        if (!isNaN(max)) filtered = filtered.filter(p => (p.onSale ? p.discountPrice : p.price) <= max);

        if (currentFilters.sizes.length > 0) filtered = filtered.filter(p => p.sizes && p.sizes.some(size => currentFilters.sizes.includes(size)));
        const searchTerm = searchInput.value.toLowerCase().trim();

        if (searchTerm) filtered = filtered.filter(p => p.name.toLowerCase().includes(searchTerm));

        if (currentSort === 'price-asc') {
            filtered.sort((a, b) => {
                const priceA = a.onSale ? a.discountPrice : a.price;
                const priceB = b.onSale ? b.discountPrice : b.price;
                return priceA - priceB;

           });
        } else if (currentSort === 'price-desc') {
            filtered.sort((a, b) => {
                const priceA = a.onSale ? a.discountPrice : a.price;
                const priceB = b.onSale ? b.discountPrice : b.price;
                return priceB - priceA;

          });
        } else if (currentSort === 'newest') {
            filtered.sort((a, b) => b.id - a.id);

        }

        renderProducts(filtered);
    };

    // ========================================================================================= //
    // --- SEPET FONKSÄ°YONLARI ---
    // ========================================================================================= //
    const saveCart = () => sessionStorage.setItem('cart', JSON.stringify(cart));

    const openCart = () => { renderCart(); cartPanel.classList.add('open'); cartOverlay.style.display = 'block'; };
    const closeCart = () => { cartPanel.classList.remove('open');

    cartOverlay.style.display = 'none'; };

    const addToCart = (productId, quantity = 1, options = {}) => {
        const product = productsDB.find(p => p.id === productId);

        if (!product) return;
        
        let itemIdentifier = `${productId}`;
        if (options.color) itemIdentifier += `-${options.color.name.replace(/\s/g, '')}`;
        if (options.size) itemIdentifier += `-${options.size}`;

        const existingItem = cart.find(item => item.id === itemIdentifier);

        if (existingItem) {
            if (existingItem.quantity + quantity <= product.stock) {
                existingItem.quantity += quantity;

                showNotification(`${product.name} adedi artÄ±rÄ±ldÄ±.`, 'success');
            } else {
                showNotification(`Stokta yeterli ${product.name} yok!`, 'error');

            }
        } else {
             const newItem = {
                id: itemIdentifier,
                productId: productId,
                quantity: quantity,
                ...options
            };
            cart.push(newItem);
            showNotification(`${product.name} sepete eklendi.`, 'success');
        }
        saveCart();
        renderCart();
        const cartIcon = document.querySelector('.cart-icon-wrapper');

        if (cartIcon) {
            cartIcon.classList.remove('pop');
            void cartIcon.offsetWidth;
            cartIcon.classList.add('pop');

        }
    };
    const updateQuantity = (itemId, newQuantity) => {
        const itemInCart = cart.find(item => item.id === itemId);

        if (!itemInCart) return;
        const product = productsDB.find(p => p.id === itemInCart.productId);
        if (!product) return;

        if (newQuantity > 0 && newQuantity <= product.stock) {
            itemInCart.quantity = newQuantity;

        } else if (newQuantity > product.stock) {
            showNotification(`Stokta sadece ${product.stock} adet mevcut!`, 'error');

            itemInCart.quantity = product.stock;
        } else {
            cart = cart.filter(item => item.id !== itemId);

        }
        saveCart();
        renderCart();
    };

    const removeFromCart = (itemId) => {
        cart = cart.filter(item => item.id !== itemId);

        saveCart();
        renderCart();
    };
    const applyCoupon = () => {
        const couponInput = document.getElementById('coupon-input');

        const code = couponInput.value.trim().toUpperCase();
        if (code === 'BEDAVA10') {
            coupon = { code: 'BEDAVA10', discount: 0.10 };

            showNotification('Kupon baÅŸarÄ±yla uygulandÄ±!', 'success');
        } else {
            coupon = null;

            showNotification('GeÃ§ersiz kupon kodu.', 'error');
        }
        couponInput.value = '';
        updateTotals();
    };

    const updateTotals = () => {
        const subtotal = cart.reduce((total, item) => {
            const product = productsDB.find(p => p.id === item.productId);
            const price = product.onSale ? product.discountPrice : product.price;
            return total + (price * item.quantity);
        }, 0);

        const FREE_SHIPPING_THRESHOLD = 500;
        const SHIPPING_FEE = 29.99;
        const shipping = subtotal > 0 && subtotal < FREE_SHIPPING_THRESHOLD ? SHIPPING_FEE : 0;
        
        let couponDiscountAmount = 0;
        const discountLine = document.getElementById('cart-discount-line');

        if (coupon) {
            couponDiscountAmount = subtotal * coupon.discount;

        }

        let bundleDiscountAmount = 0;
        const processedBundles = new Set();

        for (const cartItem of cart) {
            const product = productsDB.find(p => p.id === cartItem.productId);

            if (product && product.bundle_offer && !processedBundles.has(product.bundle_offer.name)) {
                
                const allBundleItemsInCart = product.bundle_offer.partner_ids.every(id => cart.some(item => item.productId === id));

                if (allBundleItemsInCart) {
                    let bundleTotalPrice = product.onSale ? product.discountPrice : product.price;
                    product.bundle_offer.partner_ids.forEach(id => {
                        const partnerProduct = productsDB.find(p => p.id === id);
                        bundleTotalPrice += partnerProduct.onSale ? partnerProduct.discountPrice : partnerProduct.price;
                    });

                    bundleDiscountAmount += bundleTotalPrice * (product.bundle_offer.discount_percentage / 100);
                    processedBundles.add(product.bundle_offer.name);
                }
            }
        }
        
        const totalDiscount = couponDiscountAmount + bundleDiscountAmount;

        if (totalDiscount > 0) {
            discountLine.style.display = 'flex';

        } else {
            discountLine.style.display = 'none';

        }

        const total = subtotal + shipping - totalDiscount;

        document.getElementById('cart-subtotal').textContent = `${subtotal.toFixed(2)} â‚º`;

        document.getElementById('cart-shipping').textContent = shipping > 0 ? `${shipping.toFixed(2)} â‚º` : 'Ãœcretsiz';
        document.getElementById('cart-discount').textContent = `-${totalDiscount.toFixed(2)} â‚º`;
        document.getElementById('cart-total-price').textContent = `${total.toFixed(2)} â‚º`;

        const progressContainer = document.getElementById('free-shipping-progress');
        if (subtotal > 0 && subtotal < FREE_SHIPPING_THRESHOLD) {
            const remaining = FREE_SHIPPING_THRESHOLD - subtotal;

            progressContainer.textContent = `Ãœcretsiz kargo iÃ§in ${remaining.toFixed(2)} â‚º daha ekle!`;
            progressContainer.style.display = 'block';

        } else {
            progressContainer.style.display = 'none';

        }
    };
    const renderCart = () => {
        if (cart.length === 0) {
            cartBody.innerHTML = `<div class="cart-empty-message"><h3>Sepetiniz ÅŸu an boÅŸ.</h3><p>Hemen alÄ±ÅŸveriÅŸe baÅŸlayÄ±n!</p></div>`;

        } else {
            cartBody.innerHTML = cart.map(item => {
                const product = productsDB.find(p => p.id === item.productId);
                if (!product) return '';
                const price = product.onSale ? product.discountPrice : product.price;
                
                let attributesHTML = product.attributes;
                if(item.color) attributesHTML = `Renk: ${item.color.name}`;
                if(item.size) attributesHTML += `, Beden: ${item.size}`;
                
                return `<div class="cart-item" data-item-id="${item.id}"><img src="${product.img}" alt="${product.name}" class="cart-item-img"><div class="cart-item-details"><div class="cart-item-title">${product.name}</div><div class="cart-item-attributes">${attributesHTML}</div><div class="cart-item-price">${(price * item.quantity).toFixed(2)} â‚º</div></div><div class="cart-item-actions"><div class="quantity-control"><button class="quantity-btn decrease-qty">-</button><span class="item-quantity">${item.quantity}</span><button class="quantity-btn increase-qty">+</button></div><button class="remove-item-btn">&times;</button></div></div>`;
            }).join('');
        }
        updateTotals();
        updateCartAssistant();
        const cartItemCountEl = document.querySelector('.cart-item-count');

        if (cartItemCountEl) {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);

            if (totalItems > 0) {
                cartItemCountEl.textContent = totalItems;

                cartItemCountEl.style.display = 'flex';
                cartItemCountEl.classList.add('visible');
            } else {
                cartItemCountEl.style.display = 'none';

                cartItemCountEl.classList.remove('visible');
            }
        }
    };

    const updateCartAssistant = () => {
        const assistantContainer = document.getElementById('cart-assistant-container');

        const assistantBody = document.getElementById('assistant-body');
        assistantBody.innerHTML = '';

        if (cart.length === 0) {
            assistantContainer.style.display = 'none';

            return;
        }

        let offersHTML = new Set();

        for (const cartItem of cart) {
            const product = productsDB.find(p => p.id === cartItem.productId);

            if (!product) continue;

            if (product.related_products) {
                for (const related of product.related_products) {
                    if (!cart.some(item => item.productId === related.id)) {
                        const relatedProduct = productsDB.find(p => p.id === related.id);

                        if(relatedProduct) {
                            offersHTML.add(`
                                <div class="assistant-offer">
                                    <p><strong>${product.name}</strong> iÃ§in harika bir tamamlayÄ±cÄ±!</p>
                                    <div class="suggestion-product">
                                        <img src="${relatedProduct.img}" alt="${relatedProduct.name}">

                                        <div class="suggestion-product-info">
                                            <strong>${relatedProduct.name}</strong>

                                            <span>${(relatedProduct.onSale ? relatedProduct.discountPrice : relatedProduct.price).toFixed(2)} â‚º</span>
                                        </div>
                                        <button class="add-to-cart-btn" data-product-id="${relatedProduct.id}">Ekle</button>

                                 </div>
                                </div>`);

                        }
                    }
                }
            }
            
            if (product.bundle_offer) {
                const allPartnerIds = [product.id, ...product.bundle_offer.partner_ids];

                const itemsInCartForBundle = cart.filter(item => allPartnerIds.includes(item.productId));
                const uniqueItemsInCartForBundle = [...new Set(itemsInCartForBundle.map(item => item.productId))];

                if (uniqueItemsInCartForBundle.length < allPartnerIds.length) {
                    const missingPartnerIds = allPartnerIds.filter(id => !uniqueItemsInCartForBundle.includes(id));

                    offersHTML.add(`
                        <div class="assistant-offer">
                            <p><strong>${product.bundle_offer.name} FÄ±rsatÄ±:</strong> ${product.bundle_offer.text}</p>
                            ${missingPartnerIds.map(id => {

                                const p = productsDB.find(prod => prod.id === id);
                                return `<div class="suggestion-product" style="margin-bottom: 8px;">
                                    <img src="${p.img}" alt="${p.name}">

                                   <div class="suggestion-product-info"><strong>${p.name}</strong></div>
                                    <button class="add-to-cart-btn" data-product-id="${p.id}">Ekle</button>

                               </div>`;
                            }).join('')}
                        </div>`);

                }
            }
        }

        if (offersHTML.size > 0) {
            assistantContainer.style.display = 'block';

            assistantBody.innerHTML = [...offersHTML].join('');
        } else {
            assistantContainer.style.display = 'none';

        }
    };
    
    // ========================================================================================= //
    // --- Ã–DEME AKIÅI YÃ–NETÄ°MÄ° ---
    // ========================================================================================= //
    const initCheckout = () => {
        if (cart.length === 0) {
            showNotification('Ã–deme yapmak iÃ§in sepetinizde Ã¼rÃ¼n olmalÄ±dÄ±r.', 'error');

            return;
        }
        closeCart();
        document.body.classList.add('checkout-active');
        checkoutPage.style.display = 'block';
        document.getElementById('checkout-pre-summary').style.display = 'flex';
        document.getElementById('checkout-main-content').style.display = 'none';

        renderCheckoutSummary();
        document.getElementById('pre-summary-items').innerHTML = document.getElementById('summary-items').innerHTML;
        document.getElementById('pre-summary-totals').innerHTML = document.getElementById('summary-totals').innerHTML;
        updateDeliveryDates();
    };
    const closeCheckout = () => {
        document.body.classList.remove('checkout-active');

        checkoutPage.style.display = 'none';
    };
    const goToStep = (stepIdentifier) => {
        document.querySelectorAll('.checkout-step').forEach(s => s.classList.remove('active'));

        const stepEl = document.getElementById(stepIdentifier);
        if (stepEl) stepEl.classList.add('active');

        const isConfirmation = stepIdentifier === 'order-confirmation';
        const currentStepNumber = isConfirmation ? 4 : parseInt(stepIdentifier.replace('step-', ''));

        document.querySelectorAll('.progress-step-graphic').forEach(ps => {
            const graphicStepNumber = parseInt(ps.dataset.step);
            ps.classList.toggle('active', graphicStepNumber <= currentStepNumber);
        });

    };
    const renderCheckoutSummary = () => {
        document.getElementById('summary-items').innerHTML = cart.map(item => {
            const product = productsDB.find(p => p.id === item.productId);
            const price = product.onSale ? product.discountPrice : product.price;
            return `<div class="summary-item"><img src="${product.img}" class="summary-item-img"><div class="summary-item-info"><div>${product.name}</div><span>Adet: ${item.quantity}</span></div><strong class="summary-item-price">${(price * item.quantity).toFixed(2)} â‚º</strong></div>`;
        }).join('');

        updateCheckoutTotals();
    };
    const updateCheckoutTotals = () => {
        const subtotal = cart.reduce((total, item) => {
            const product = productsDB.find(p => p.id === item.productId);
            return total + ((product.onSale ? product.discountPrice : product.price) * item.quantity);
        }, 0);

        const shipping = checkoutState.delivery.price;
        const giftWrapFee = checkoutState.giftWrap ? 19.99 : 0;
        let discountAmount = 0;

        if(coupon) {
            discountAmount = subtotal * coupon.discount;

            document.getElementById('summary-discount-line').style.display = 'flex';
            document.getElementById('summary-discount').textContent = `-${discountAmount.toFixed(2)} â‚º`;
        } else {
            document.getElementById('summary-discount-line').style.display = 'none';

        }
        const total = subtotal + shipping + giftWrapFee - discountAmount;

        document.getElementById('summary-subtotal').textContent = `${subtotal.toFixed(2)} â‚º`;
        document.getElementById('summary-shipping').textContent = `${shipping.toFixed(2)} â‚º`;
        document.getElementById('summary-total').textContent = `${total.toFixed(2)} â‚º`;
    };

    const updateDeliveryDates = () => {
        const today = new Date();

        const formatDate = (date) => `${date.getDate()} ${date.toLocaleString('tr-TR', { month: 'long' })}`;
        const standartStart = new Date(today);
        standartStart.setDate(today.getDate() + 3);

        const standartEnd = new Date(today);
        standartEnd.setDate(today.getDate() + 5);
        const ekspresStart = new Date(today);
        ekspresStart.setDate(today.getDate() + 1);
        const standartEl = document.querySelector('.delivery-date-standart');

        const ekspresEl = document.querySelector('.delivery-date-ekspres');
        if (standartEl) standartEl.textContent = `${formatDate(standartStart)} - ${formatDate(standartEnd)}`;
        if (ekspresEl) ekspresEl.textContent = `${formatDate(ekspresStart)}`;
    };

    const populateConfirmationScreen = (order, earnedBC) => {
        const user = getActiveUser();

        document.getElementById('conf-order-number').textContent = `#${order.id}`;
        document.getElementById('conf-delivery-date').textContent = order.delivery.estimatedDate;
        document.getElementById('conf-shipping-co').textContent = order.delivery.company;
        document.getElementById('conf-total-price').textContent = `${order.total.toFixed(2)} â‚º`;
        document.getElementById('conf-bc-earned').textContent = `${earnedBC} BC PuanÄ±`;

        document.getElementById('conf-bc-total').textContent = `${user.bc} BC`;
        
        const itemsList = document.getElementById('conf-items-list');
        itemsList.innerHTML = order.items.map(item => {
             const product = productsDB.find(p => p.id === item.productId);
             return `
                <div class="conf-item">
                    <img src="${product.img}" alt="${product.name}" class="conf-item-img">

                    <div>
                        <strong>${product.name}</strong>
                        <div style="font-size:0.9em; color:#666;">Adet: ${item.quantity}</div>
                    </div>
                </div>`;

        }).join('');
    };

    function setupTreasureHunt() {
        const today = new Date().toDateString();

        const lastVisitDate = localStorage.getItem('lastTreasureVisit');
        
        if (lastVisitDate !== today) {
            const randomProductIndex = Math.floor(Math.random() * productsDB.length);

            treasureProductId = productsDB[randomProductIndex].id;
            localStorage.setItem('treasureProductId', treasureProductId);
            localStorage.setItem('lastTreasureVisit', today);
        } else {
            treasureProductId = parseInt(localStorage.getItem('treasureProductId'));

        }

        const treasureProduct = productsDB.find(p => p.id === treasureProductId);

        if (treasureProduct) {
            const clueElement = document.getElementById('treasure-clue');

            if(clueElement) {
                const categoryMap = { 'teknoloji': 'Teknoloji', 'kozmetik': 'Kozmetik', 'moda': 'Moda', 'ev-yasam': 'Ev & YaÅŸam' };

                clueElement.textContent = `"${categoryMap[treasureProduct.category]}"`;
            }
            const bannerElement = document.getElementById('treasure-hunt-banner');

            if(bannerElement) bannerElement.style.display = 'block';
        }
    }
    function claimTreasure() {
        const user = getActiveUser();

        const today = new Date().toDateString();

        if (!user) {
            showNotification('Ã–dÃ¼lÃ¼ almak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z!', 'error');

            openModal(loginModal);
            return;
        }

        if (user.lastTreasureClaimDate === today) {
            showNotification('BugÃ¼nkÃ¼ hazineyi zaten buldun!', 'error');

            return;
        }

        showNotification('Tebrikler! 50 BC kazandÄ±nÄ±z!', 'success');

        user.bc = (user.bc || 0) + 50;
        user.lastTreasureClaimDate = today;
        updateActiveUser(user);

        document.querySelectorAll('.treasure-chest').forEach(chest => {
            chest.style.display = 'none';
        });

        updateUI(); 
    }

    const updateUI = () => {
        const user = getActiveUser();

        if (user) {
            loggedOutMenu.style.display = 'none';
            loggedInMenu.style.display = 'block';

            document.getElementById('menu-username').textContent = `${user.name} ${user.surname}`;

            document.getElementById('menu-user-email').textContent = user.email;
            document.getElementById('menu-user-bc').textContent = user.bc || 0;
            
            const userInitials = (user.name ? user.name[0] : '') + (user.surname ? user.surname[0] : '');

            document.getElementById('user-initials').textContent = userInitials.toUpperCase();

        } else {
            loggedOutMenu.style.display = 'block';

            loggedInMenu.style.display = 'none';
        }
        updateFavoriteIcons();
    };

    const getReviewsDatabase = () => JSON.parse(localStorage.getItem('productReviews')) || {};
    const saveReviewsDatabase = (db) => localStorage.setItem('productReviews', JSON.stringify(db));

    const addReview = (productId, reviewText, rating, imageSrc) => {
        const db = getReviewsDatabase();

        if (!db[productId]) {
            db[productId] = [];

        }
        const user = getActiveUser();

        const newReview = {
            id: Date.now(),
            author: user ? user.name : 'Anonim',
            userId: user ? user.email : null,
            text: reviewText,
            rating: rating,
            image: imageSrc,
            hasPurchased: user ? (user.orders && user.orders.some(order => order.items.some(item => item.productId === productId))) : false
        };
        db[productId].unshift(newReview);

        saveReviewsDatabase(db);
    };
    const deleteReview = (productId, reviewId) => {
        const db = getReviewsDatabase();

        if (db[productId]) {
            db[productId] = db[productId].filter(review => review.id !== reviewId);

            saveReviewsDatabase(db);
        }
    };

    const renderReviews = (productId) => {
        const db = getReviewsDatabase();

        const reviews = db[productId] || [];
        const reviewsListContainer = document.getElementById('reviewsListDetail');
        const currentUser = getActiveUser();

        if (reviews.length === 0) {
            reviewsListContainer.innerHTML = "<p style='color:#888;'>HenÃ¼z yorum yapÄ±lmamÄ±ÅŸ.</p>";

            return;
        }

        reviewsListContainer.innerHTML = reviews.map(review => {
            const imageHTML = review.image ? `<img src="${review.image}" class="review-item-image" alt="review image">` : '';
            
            let verifiedBadgeHTML = '';
            if (review.hasPurchased) {
                verifiedBadgeHTML = `

               <span class="verified-purchase-badge">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></svg>
                        OnaylÄ± SatÄ±n AlÄ±m

          </span>`;
            }

            const deleteButtonHTML = (currentUser && currentUser.email === review.userId) 
                ? `<button class="delete-review-btn" data-review-id="${review.id}" title="Yorumu Sil">ğŸ—‘ï¸</button>` 
                : '';

            return `

            <div class="review-item">
                <div class="review-item-header">
                    <div class="review-author-wrapper">
                        <span class="review-item-author">${review.author.replace(/</g, "&lt;")}</span>
                        ${verifiedBadgeHTML}

                    </div>
                    <div class="review-item-stars">${'â˜…'.repeat(review.rating)}${'â˜†'.repeat(5 - review.rating)}</div>
                </div>
                <p class="review-item-text">${review.text.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</p>
                ${imageHTML}

                ${deleteButtonHTML}
            </div>`;
        }).join('');
    };
    
    // YENÄ°LENMÄ°Å ÃœRÃœN DETAY MODALI FONKSÄ°YONU
    function openProductDetail(product) {
        currentDetailProductId = product.id;
        favoriteBtnDetail.dataset.productId = product.id;
        
        detailNameNew.textContent = product.name;
        detailDescription.textContent = product.attributes || "Bu Ã¼rÃ¼n iÃ§in detaylÄ± bir aÃ§Ä±klama henÃ¼z eklenmemiÅŸtir.";
        
        if (product.onSale) {
            detailPriceNew.textContent = `${product.discountPrice.toFixed(2)} â‚º`;
            detailDiscountNew.textContent = `${product.price.toFixed(2)} â‚º`;
            detailDiscountNew.style.display = 'inline';
        } else {
            detailPriceNew.textContent = `${product.price.toFixed(2)} â‚º`;
            detailDiscountNew.style.display = 'none';
        }

        // Stok durumu
        if (product.stock > 5) {
            detailStockStatus.textContent = 'Stokta Var';
            detailStockStatus.className = 'stock-status in-stock';
        } else if (product.stock > 0) {
            detailStockStatus.textContent = `Son ${product.stock} Ã¼rÃ¼n!`;
            detailStockStatus.className = 'stock-status low-stock';
        } else {
            detailStockStatus.textContent = 'TÃ¼kendi';
            detailStockStatus.className = 'stock-status out-of-stock';
        }
        
        // Resim Galerisi
        const images = product.images && product.images.length > 0 ? product.images : [product.img];
        detailMainImage.src = images[0];
        detailThumbnails.innerHTML = images.map((imgSrc, index) => 
            `<img src="${imgSrc}" class="detail-thumbnail ${index === 0 ? 'selected' : ''}" alt="thumbnail ${index+1}">`
        ).join('');

        // Renk SeÃ§enekleri
        if (product.colors && product.colors.length > 0) {
            detailColorsContainer.style.display = 'flex';
            detailColorSelector.innerHTML = product.colors.map(color => 
                `<div class="color-swatch" data-color-name="${color.name}" style="background-color:${color.hex};" title="${color.name}"></div>`
            ).join('');
        } else {
            detailColorsContainer.style.display = 'none';
        }
        
        // Beden SeÃ§enekleri
        if (product.sizes && product.sizes.length > 0) {
            detailSizesContainer.style.display = 'flex';
            detailSizeSelector.innerHTML = product.sizes.map(size => `<button data-size="${size}">${size}</button>`).join('');
        } else {
            detailSizesContainer.style.display = 'none';
        }

        quantityInputDetail.value = 1;
        quantityInputDetail.max = product.stock;
        
        updateFavoriteIcons();
        renderReviews(currentDetailProductId);
        resetReviewForm();
        openModal(productDetailModal);
    }

    function resetReviewForm() {
        detailRating = 0;
        reviewTextDetail.value = '';

        reviewImageDetail.value = '';
        starRatingDetail.forEach(s => s.classList.remove('selected'));
    }

    async function loadVTOModel() {
        try {
             faceMeshModel = await faceLandmarksDetection.load(
                faceLandmarksDetection.SupportedPackages.medipeFacemesh,
                { maxFaces: 1 }

            );
            console.log("YÃ¼z tanÄ±ma modeli baÅŸarÄ±yla yÃ¼klendi.");

        } catch (error) {
            console.error("YÃ¼z tanÄ±ma modeli yÃ¼klenemedi:", error);

            showNotification("Sanal deneme Ã¶zelliÄŸi yÃ¼klenemedi.", "error");
        }
    }
    async function startVTO(product) {
        if (!faceMeshModel) {
            showNotification("Sanal deneme Ã¶zelliÄŸi henÃ¼z hazÄ±r deÄŸil, lÃ¼tfen bekleyin.", "error");

            return;
        }
        
        try {
            videoStream = await navigator.mediaDevices.getUserMedia({
                video: { width: 640, height: 480 },
                audio: false
            });

            vtoVideo.srcObject = videoStream;
            await vtoVideo.play();
            
            vtoOverlay.style.display = 'flex';
            vtoIsRunning = true;
            currentVTOProduct = product;
            currentVTOColor = product.colors[0].hex;

            vtoProductName.textContent = product.name;

            vtoProductColors.innerHTML = product.colors.map((color, index) =>
                `<div class="vto-color-swatch ${index === 0 ? 'selected' : ''}" style="background-color: ${color.hex};" data-color="${color.hex}" title="${color.name}"></div>`
            ).join('');

            vtoAddToCartBtn.dataset.productId = product.id;
            vtoAnimationId = requestAnimationFrame(renderMakeupEffect);
        } catch (err) {
            console.error("Kamera eriÅŸim hatasÄ±:", err);

            showNotification("Kamera eriÅŸimi reddedildi veya bir hata oluÅŸtu.", "error");
        }
    }
    function stopVTO() {
        if (videoStream) {
            videoStream.getTracks().forEach(track => track.stop());

        }
        vtoIsRunning = false;
        if(vtoAnimationId) cancelAnimationFrame(vtoAnimationId);
        vtoOverlay.style.display = 'none';
        const ctx = vtoCanvas.getContext('2d');

        ctx.clearRect(0, 0, vtoCanvas.width, vtoCanvas.height);
    }
    const LIP_KEYPOINTS = [ 61, 146, 91, 181, 84, 17, 314, 405, 321, 375, 291, 308, 324, 318, 402, 317, 14, 87, 178, 88, 95, 78, 191, 80, 81, 82, 13, 312, 311, 310, 415, 308 ];

    async function renderMakeupEffect() {
        if (!vtoIsRunning) return;
        const ctx = vtoCanvas.getContext('2d');

        vtoCanvas.width = vtoVideo.videoWidth;
        vtoCanvas.height = vtoVideo.videoHeight;
        
        const predictions = await faceMeshModel.estimateFaces({ input: vtoVideo });
        ctx.clearRect(0, 0, vtoCanvas.width, vtoCanvas.height);

        if (predictions.length > 0) {
            const keypoints = predictions[0].scaledMesh;

            ctx.beginPath();
            LIP_KEYPOINTS.forEach((pointIndex, i) => {
                const [x, y] = keypoints[pointIndex];
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });

            ctx.closePath();
            
            ctx.globalAlpha = 0.6;
            ctx.fillStyle = currentVTOColor;
            ctx.fill();
            ctx.globalAlpha = 1.0;

        }

        vtoAnimationId = requestAnimationFrame(renderMakeupEffect);

    }

    // ========================================================================================= //
    // --- EVENT LISTENERS (OLAY DÄ°NLEYÄ°CÄ°LERÄ°) ---
    // ========================================================================================= //
    
    sortBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        sortPanel.classList.toggle('open');
    });

    sortPanel.addEventListener('click', (e) => {
        e.preventDefault();
        if (e.target.classList.contains('sort-option')) {
            currentSort = e.target.dataset.sort;
            document.getElementById('current-sort-display').textContent = e.target.textContent;
            applyAllFilters();
            sortPanel.classList.remove('open');
        }
    });

    document.getElementById('register-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const users = getUserDatabase();
        const newUser = {
            name: document.getElementById('reg-name').value.trim(),
            surname: document.getElementById('reg-surname').value.trim(),
            phone: document.getElementById('reg-phone').value.trim(),
            email: document.getElementById('reg-email').value.trim().toLowerCase(),
            username: document.getElementById('reg-username').value.trim(),

            password: document.getElementById('reg-password').value,
            bc: 0, orders: [], favorites: []
        };
        if (!validateUsername(newUser.username) || !validateEmail(newUser.email) || !validatePassword(newUser.password)) { showNotification('LÃ¼tfen tÃ¼m alanlarÄ± kurallara uygun doldurun.', 'error'); return; }
        if (users.some(user => user.username.toLowerCase() === newUser.username.toLowerCase())) { showNotification('Bu kullanÄ±cÄ± adÄ± zaten alÄ±nmÄ±ÅŸ.', 'error'); return; }
        if (users.some(user => user.email === newUser.email)) { showNotification('Bu e-posta adresi zaten kullanÄ±lÄ±yor.', 'error'); return; }
        users.push(newUser);
        saveUserDatabase(users);
        showNotification('KayÄ±t olundu! Åimdi giriÅŸ yapabilirsiniz.', 'success');
        e.target.reset();
        openModal(loginModal);
    });

    document.getElementById('login-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const identifier = document.getElementById('login-username').value.trim().toLowerCase();
        const password = document.getElementById('login-password').value;
        const users = getUserDatabase();
        const foundUser = users.find(user => (user.username.toLowerCase() === identifier || user.email === identifier) && user.password === password);
        if (foundUser) { setActiveUser(foundUser); closeModal(); updateUI(); showNotification(`HoÅŸ geldin, ${foundUser.name}!`, 'success'); } else { showNotification('KullanÄ±cÄ± adÄ±/e-posta veya ÅŸifre yanlÄ±ÅŸ.', 'error'); }
    });

    profileModal.addEventListener('submit', e => {
        if(e.target.id === 'profile-edit-form'){
            e.preventDefault();
            const currentUser = getActiveUser(); if(!currentUser) return;
            
            const updatedUser = {
                ...currentUser,

                name: document.getElementById('edit-name').value.trim(),
                surname: document.getElementById('edit-surname').value.trim(),
                username: document.getElementById('edit-username').value.trim(),
                email: document.getElementById('edit-email').value.trim().toLowerCase(),
                phone: document.getElementById('edit-phone').value.trim()
            };

            const updatedPassword = document.getElementById('edit-password').value;
             if (updatedPassword) {
                updatedUser.password = updatedPassword;
            }

            updateActiveUser(updatedUser);

            showNotification('Profil bilgileri baÅŸarÄ±yla gÃ¼ncellendi.', 'success');
            closeModal();
            updateUI();
        }
    });

    const handleSocialLogin = (provider) => {
        const users = getUserDatabase();

        const email = `user@${provider.toLowerCase()}.com`;
        let user = users.find(u => u.email === email);

        if (!user) { user = { name: `${provider} KullanÄ±cÄ±sÄ±`, surname: '', phone: '', email: email, username: `${provider.toLowerCase()}_user`, password: 'sociallogin', bc: 0, orders: [], favorites: [] };

        users.push(user); saveUserDatabase(users); }
        setActiveUser(user); closeModal(); updateUI();
        showNotification(`HoÅŸ geldin, ${user.name}!`, 'success');
    };

    document.getElementById('google-login-btn').addEventListener('click', () => handleSocialLogin('Google'));

    profileIconWrapper.addEventListener('click', (e) => {
        e.stopPropagation();
        profileMenu.classList.toggle('open');
    });

    categoriesIcon.addEventListener('click', (e) => {
        e.stopPropagation();
        categoriesDropdown.style.display = categoriesDropdown.style.display === 'block' ? 'none' : 'block';
    });

    document.body.addEventListener('click', (e) => {
        if (!searchBanner.contains(e.target)) {
            document.getElementById('search-results-panel').style.display = 'none';
        }
        if (profileMenu.classList.contains('open') && !profileIconWrapper.contains(e.target)) {
            profileMenu.classList.remove('open');
        }
        if (categoriesDropdown.style.display === 'block' && !categoriesIcon.contains(e.target)) {
            categoriesDropdown.style.display = 'none';

        }
        if (sortPanel.classList.contains('open') && !sortBtn.contains(e.target)) {
            sortPanel.classList.remove('open');
        }
        if (filterPanel.classList.contains('open') && e.target === cartOverlay) {
             filterPanel.classList.remove('open');
             cartOverlay.style.display = 'none';
        }
        if (modalOverlay.style.display === 'flex' && e.target === modalOverlay) {
            closeModal();
        }
    });

    profileMenu.addEventListener('click', (e) => {
        const target = e.target.closest('a, button');
        if (!target) return;

        e.preventDefault();
        const action = target.id;
        
        const actions = {
            'menu-login-btn': () => openModal(loginModal),

            'menu-register-btn': () => openModal(registerModal),
            'menu-profile-link': () => { renderProfileModal(); openModal(profileModal); },
            'menu-orders-link': () => { renderOrders(); openModal(ordersModal); },
            'menu-favorites-link': () => { renderFavorites(); openModal(favoritesModal); },
            'menu-coupons-link': () => { renderCoupons(); openModal(couponsModal); },
            'menu-settings-link': () => openModal(settingsModal),

            'menu-help-link': () => openModal(helpModal),
            'menu-logout-btn': () => { logoutUser(); updateUI(); showNotification('BaÅŸarÄ±yla Ã§Ä±kÄ±ÅŸ yapÄ±ldÄ±.', 'success'); },
        };
        if (actions[action]) {
            actions[action]();

            profileMenu.classList.remove('open');
        }
    });

    document.getElementById('show-register').addEventListener('click', (e) => {
        e.preventDefault();
        openModal(registerModal);
    });

    document.getElementById('show-login').addEventListener('click', (e) => {
        e.preventDefault();
        openModal(loginModal);
    });

    cartOpenBtn.addEventListener('click', openCart);
    document.getElementById('cart-close-btn').addEventListener('click', closeCart);
    document.getElementById('continue-shopping-btn').addEventListener('click', closeCart);
    cartOverlay.addEventListener('click', (e) => {
        if(e.target === cartOverlay && !filterPanel.classList.contains('open')){
            closeCart();
        }
    });

    cartBody.addEventListener('click', e => {
        const itemElement = e.target.closest('.cart-item');
        if (!itemElement) return;
        const itemId = itemElement.dataset.itemId;
        let item = cart.find(i => i.id === itemId);
        if (!item) return;

        if (e.target.matches('.increase-qty')) updateQuantity(itemId, item.quantity + 1);
        if (e.target.matches('.decrease-qty')) updateQuantity(itemId, item.quantity - 1);
        if (e.target.matches('.remove-item-btn')) removeFromCart(itemId);

    });
    document.getElementById('apply-coupon-btn').addEventListener('click', applyCoupon);
    document.getElementById('checkout-btn').addEventListener('click', initCheckout);
    document.getElementById('back-to-store-link').addEventListener('click', (e) => { e.preventDefault(); closeCheckout(); });

    document.querySelectorAll('.next-btn, .back-link').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            const targetStep = btn.dataset.next || btn.dataset.back; if (!targetStep) return;
            const currentStepEl = btn.closest('.checkout-step');
            if (btn.dataset.next) {
                 if (currentStepEl.id === 'step-1') {

                    const form = document.getElementById('address-form');
                    if (!form.checkValidity()) { form.reportValidity(); return; }
                    checkoutState.address = { name: form.fname.value, surname: form.lname.value, address: form.address.value, city: form.city.value, zip: form.zip.value, phone: form.phone.value };
                }

                if (currentStepEl.id === 'step-3') {
                    document.getElementById('review-address').textContent = `${checkoutState.address.address}, ${checkoutState.address.zip} ${checkoutState.address.city}`;
                    document.getElementById('review-delivery').textContent = document.querySelector(`input[name="delivery"]:checked`).parentElement.querySelector('.option-header span').textContent;

                    document.getElementById('review-payment').textContent = document.querySelector(`input[name="payment"]:checked`).parentElement.textContent.trim();
                }
            }
            goToStep(targetStep);

        });
    });

    document.querySelectorAll('#delivery-options .option-box').forEach(box => { box.addEventListener('click', () => { document.querySelectorAll('#delivery-options .option-box').forEach(b => b.classList.remove('selected')); box.classList.add('selected'); const radio = box.querySelector('input'); checkoutState.delivery = { type: radio.value, price: parseFloat(radio.dataset.price) }; updateCheckoutTotals(); }); });

    document.getElementById('gift-wrap-check').addEventListener('change', (e) => { checkoutState.giftWrap = e.target.checked; updateCheckoutTotals(); });
    document.getElementById('back-to-home-final').addEventListener('click', closeCheckout);

    document.getElementById('proceed-to-payment-btn').addEventListener('click', () => { document.getElementById('checkout-pre-summary').style.display = 'none'; document.getElementById('checkout-main-content').style.display = 'grid'; goToStep('step-1'); });
    document.getElementById('continue-shopping-from-summary-btn').addEventListener('click', closeCheckout);

    document.getElementById('back-to-cart-link-pre-summary').addEventListener('click', (e) => { e.preventDefault(); closeCheckout(); openCart(); });
    document.getElementById('back-to-summary-link').addEventListener('click', (e) => { e.preventDefault(); document.getElementById('checkout-main-content').style.display = 'none'; document.getElementById('checkout-pre-summary').style.display = 'flex'; });

    document.getElementById('confirm-order-btn').addEventListener('click', () => {
        const currentUser = getActiveUser(); if (!currentUser) { showNotification('SipariÅŸi tamamlamak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z!', 'error'); openModal(loginModal); return; }
        const now = new Date(); const deliveryDate = new Date(); deliveryDate.setDate(now.getDate() + (checkoutState.delivery.type === 'ekspres' ? 2 : 5));
        const subtotal = cart.reduce((total, item) => { const product = productsDB.find(p => p.id === item.productId); return total + ((product.onSale ? product.discountPrice : product.price) * item.quantity); }, 0);
        const total = subtotal + checkoutState.delivery.price + (checkoutState.giftWrap ? 19.99 : 0) - (coupon ? subtotal * coupon.discount : 0);
        const earnedBC = Math.floor(total / 100);
        const newOrder = { id: Date.now(), date: now.getTime(), items: [...cart], total: total, status: 'HazÄ±rlanÄ±yor', delivery: { type: checkoutState.delivery.type, price: checkoutState.delivery.price, company: checkoutState.delivery.type === 'ekspres' ? 'HÄ±zlÄ± Kargo A.Å.' : 'Standart Kargo', estimatedDate: deliveryDate.toLocaleDateString('tr-TR') }, address: checkoutState.address };
        currentUser.bc = (currentUser.bc || 0) + earnedBC;

        currentUser.orders = [...(currentUser.orders || []), newOrder];
        updateActiveUser(currentUser);
        populateConfirmationScreen(newOrder, earnedBC);
        cart = []; sessionStorage.removeItem('cart'); coupon = null;
        renderCart();
        goToStep('order-confirmation');
    });

    document.getElementById('home-link').addEventListener('click', (e) => { e.preventDefault(); currentFilters.category = 'all'; document.querySelectorAll('.categories-dropdown a').forEach(a => a.classList.remove('selected')); document.querySelector('.categories-dropdown a[data-category="all"]').classList.add('selected'); applyAllFilters(); });

    categoriesDropdown.addEventListener('click', (e) => { e.preventDefault(); if (e.target.tagName === 'A') { currentFilters.category = e.target.dataset.category; document.querySelectorAll('.categories-dropdown a').forEach(a => a.classList.remove('selected')); e.target.classList.add('selected'); applyAllFilters(); categoriesDropdown.style.display = 'none';} });

    filterBtn.addEventListener('click', () => {
        filterPanel.classList.toggle('open');
        if (window.innerWidth <= 768 && filterPanel.classList.contains('open')) {
            cartOverlay.style.display = 'block';
        } else {
            cartOverlay.style.display = 'none';
        }
    });

    const closeFilterPanelBtn = document.querySelector('.close-filter-panel');
    if (closeFilterPanelBtn) {
        closeFilterPanelBtn.addEventListener('click', () => {
            filterPanel.classList.remove('open');
            cartOverlay.style.display = 'none';
        });

    }

    document.getElementById('min-price').addEventListener('input', (e) => { currentFilters.minPrice = e.target.value; applyAllFilters(); });

    document.getElementById('max-price').addEventListener('input', (e) => { currentFilters.maxPrice = e.target.value; applyAllFilters(); });
    document.getElementById('on-sale-checkbox').addEventListener('change', (e) => { currentFilters.onSale = e.target.checked; applyAllFilters(); });

    document.getElementById('size-selector').addEventListener('click', (e) => { if (e.target.tagName === 'BUTTON') { const size = e.target.dataset.size; e.target.classList.toggle('selected'); if (currentFilters.sizes.includes(size)) { currentFilters.sizes = currentFilters.sizes.filter(s => s !== size); } else { currentFilters.sizes.push(size); } applyAllFilters(); } });

    document.getElementById('search-icon-btn').addEventListener('click', () => { searchBanner.classList.add('search-active'); searchInput.focus(); });
    document.getElementById('search-close-btn').addEventListener('click', () => { searchInput.value = ''; applyAllFilters(); searchBanner.classList.remove('search-active'); document.getElementById('search-results-panel').style.display = 'none'; });

    searchInput.addEventListener('input', () => {
        applyAllFilters();
        showLiveSearchResults();
    });

    document.getElementById('search-results-panel').addEventListener('click', (e) => {
        const item = e.target.closest('.search-result-item');
        if (item) {
            const productId = parseInt(item.dataset.productId);
            const product = productsDB.find(p => p.id === productId);
            if (product) {
                openProductDetail(product);

                document.getElementById('search-results-panel').style.display = 'none';
                searchBanner.classList.remove('search-active');
                searchInput.value = '';
                applyAllFilters();
            }
        }
    });

    starRatingDetail.forEach(star => { star.addEventListener('click', () => { detailRating = parseInt(star.dataset.value); starRatingDetail.forEach((s, index) => s.classList.toggle('selected', index < detailRating)); }); });

    submitReviewDetail.addEventListener('click', () => {
        const user = getActiveUser();
        if (!user) {
            showNotification('Yorum yapmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z.', 'error');
            openModal(loginModal);
            return;
        }
        const reviewText = reviewTextDetail.value.trim();
        if (!detailRating || !reviewText) {

            showNotification('LÃ¼tfen puan verin ve bir yorum yazÄ±n.', 'error');
            return;
        }

        if (reviewImageDetail.files.length > 0) {
            const reader = new FileReader();
            reader.onloadend = function() {
                const imageBase64 = reader.result;

                addReview(currentDetailProductId, reviewText, detailRating, imageBase64);
                renderReviews(currentDetailProductId);
                resetReviewForm();
            };
            reader.readAsDataURL(reviewImageDetail.files[0]);
        } else {
            addReview(currentDetailProductId, reviewText, detailRating, null);

            renderReviews(currentDetailProductId);
            resetReviewForm();
        }
        
        showNotification('Yorumunuz iÃ§in teÅŸekkÃ¼r ederiz!', 'success');

    });

    reviewsListDetail.addEventListener('click', (e) => {
        const deleteBtn = e.target.closest('.delete-review-btn');
        if (deleteBtn) {
            const reviewId = parseInt(deleteBtn.dataset.reviewId);
            if (confirm('Bu yorumu silmek istediÄŸinizden emin misiniz?')) {
                deleteReview(currentDetailProductId, reviewId);
                renderReviews(currentDetailProductId);

                showNotification('Yorum silindi.', 'success');
            }
        }
    });

    vtoCloseBtn.addEventListener('click', stopVTO);
    vtoProductColors.addEventListener('click', (e) => {
        if (e.target.matches('.vto-color-swatch')) {
            currentVTOColor = e.target.dataset.color;
            document.querySelectorAll('.vto-color-swatch').forEach(el => el.classList.remove('selected'));
            e.target.classList.add('selected');
        }
    });

    vtoAddToCartBtn.addEventListener('click', (e) => {
        const productId = parseInt(e.target.dataset.productId);
        const product = productsDB.find(p => p.id === productId);
        const selectedColor = product.colors.find(c => c.hex === currentVTOColor);
        addToCart(productId, 1, { color: selectedColor });
        showNotification('SeÃ§ilen renk sepete eklendi!', 'success');
    });

    document.querySelectorAll('.close-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            if (btn.closest('#virtual-try-on-overlay')) {
                stopVTO();
            } else {
                closeModal();
            }
        });
    });

    if (shareModal) {
        document.getElementById('copy-share-link-btn').addEventListener('click', (e) => {
            const linkInput = document.getElementById('share-product-link');
            navigator.clipboard.writeText(linkInput.value).then(() => {
                showNotification('Link panoya kopyalandÄ±!', 'success');
            }, () => {
                showNotification('Link kopyalanamadÄ±.', 'error');

            });
        });

        shareModal.querySelector('.share-social-icons').addEventListener('click', (e) => {
            const socialLink = e.target.closest('.social-icon');
            if (socialLink) {
                e.preventDefault();
                claimShareReward();
                closeModal();
            }

        });
    }

    productGrid.addEventListener('click', (e) => {
        const target = e.target;
        const button = target.closest('button');
        const productCard = target.closest('.product-card');
        if (!productCard) return;

        const productId = parseInt(productCard.dataset.productId);
        const product = productsDB.find(p => p.id === productId);
        if (!product) return;

        if (button && button.matches('.add-to-cart-btn')) {

           addToCart(productId);
        } else if (button && button.matches('.favorite-btn')) {
            toggleFavorite(productId);
        } else if (button && button.matches('.share-btn')) {
            openShareModal(product);
        } else if (button && button.matches('.vto-trigger-btn')) {
            startVTO(product);
        } else if (target.matches('.product-image-for-detail')) {
            openProductDetail(product);
        } else if (target.matches('.treasure-chest')) {
            claimTreasure();
        }
    });

    document.getElementById('cart-panel').addEventListener('click', e => {
        if (e.target.matches('.suggestion-product button')) {
            const productId = parseInt(e.target.dataset.productId);
            addToCart(productId);
        }
    });

    ordersModal.addEventListener('change', e => {
        if (e.target.id === 'order-status-filter') {
            renderOrders(e.target.value);
        }
    });

    document.getElementById('orders-list-container').addEventListener('click', e => {
        if (e.target.matches('.track-cargo-btn')) {
            const orderId = parseInt(e.target.dataset.orderId);
            const user = getActiveUser();
            const order = user.orders.find(o => o.id === orderId);
            if (order) {
                renderTrackingInfo(order);

                openModal(trackingModal);
            }
        }
    });

    document.getElementById('favorites-list-container').addEventListener('click', e => {
        if (e.target.matches('.add-to-cart-btn')) {
            const productId = parseInt(e.target.dataset.productId);
            addToCart(productId);
            openCart();
        }
    });
    
    // YENÄ° ÃœrÃ¼n Detay Penceresi EtkileÅŸimleri
    productDetailModal.addEventListener('click', e => {
        // Galeri thumbnail'larÄ±na tÄ±klama
        if (e.target.classList.contains('detail-thumbnail')) {
            detailMainImage.src = e.target.src;
            document.querySelectorAll('.detail-thumbnail').forEach(t => t.classList.remove('selected'));
            e.target.classList.add('selected');
        }
        // Renk seÃ§imi
        if (e.target.classList.contains('color-swatch')) {
            document.querySelectorAll('.color-swatch').forEach(c => c.classList.remove('selected'));
            e.target.classList.add('selected');
        }
        // Beden seÃ§imi
        if (e.target.parentElement === detailSizeSelector && e.target.tagName === 'BUTTON') {
            document.querySelectorAll('#detailSizeSelector button').forEach(b => b.classList.remove('selected'));
            e.target.classList.add('selected');
        }
        // Adet artÄ±rma/azaltma
        const product = productsDB.find(p => p.id === currentDetailProductId);
        let qty = parseInt(quantityInputDetail.value);
        if (e.target.id === 'increaseQtyDetail' && qty < product.stock) {
            quantityInputDetail.value = qty + 1;
        }
        if (e.target.id === 'decreaseQtyDetail' && qty > 1) {
            quantityInputDetail.value = qty - 1;
        }
        // Favorilere ekleme
        if(e.target.closest('#favoriteBtnDetail')) {
            toggleFavorite(currentDetailProductId);
        }
        // Sepete ekleme
        if(e.target.closest('#addToCartDetailNew')) {
            const selectedSizeEl = detailSizeSelector.querySelector('.selected');
            const selectedColorEl = detailColorSelector.querySelector('.selected');
            
            const options = {};
            if(selectedSizeEl) options.size = selectedSizeEl.dataset.size;
            if(selectedColorEl) options.color = { name: selectedColorEl.dataset.colorName, hex: selectedColorEl.style.backgroundColor };
            
            const product = productsDB.find(p=>p.id === currentDetailProductId);
            if(product.sizes && product.sizes.length > 0 && !options.size){
                showNotification("LÃ¼tfen bir beden seÃ§in.", "error");
                return;
            }
            if(product.colors && product.colors.length > 0 && !options.color){
                showNotification("LÃ¼tfen bir renk seÃ§in.", "error");
                return;
            }

            addToCart(currentDetailProductId, parseInt(quantityInputDetail.value), options);
            openCart();
        }
    });
    
    if(profileModal) {
        profileModal.addEventListener('click', (e) => {
            if (e.target.matches('.profile-tab-link')) {
                profileModal.querySelectorAll('.profile-tab-link').forEach(tab => tab.classList.remove('active'));
                profileModal.querySelectorAll('.profile-tab-content').forEach(content => content.classList.remove('active'));
                e.target.classList.add('active');

                document.getElementById(e.target.dataset.tab).classList.add('active');
            }
        });

    }
     if(couponsModal) {
        couponsModal.addEventListener('click', (e) => {
            if (e.target.matches('.coupon-tab-link')) {
                couponsModal.querySelectorAll('.coupon-tab-link').forEach(tab => tab.classList.remove('active'));
                couponsModal.querySelectorAll('.coupon-tab-content').forEach(content => content.classList.remove('active'));
                e.target.classList.add('active');
                document.getElementById(e.target.dataset.tab).classList.add('active');

           }
        });

    }
    if (settingsModal) {
        settingsModal.addEventListener('click', (e) => {
            if (e.target.matches('.settings-menu-item')) {
                e.preventDefault();
                settingsModal.querySelectorAll('.settings-menu-item').forEach(item => item.classList.remove('active'));
                settingsModal.querySelectorAll('.setting-pane').forEach(pane => pane.classList.remove('active'));
                e.target.classList.add('active');

               document.getElementById(e.target.dataset.target).classList.add('active');
            }
        });

    }
     if(helpModal) {
        helpModal.addEventListener('click', (e) => {
            if (e.target.matches('.accordion-header')) {
                const item = e.target.parentElement;
                const content = item.querySelector('.accordion-content');
                if (item.classList.contains('active')) {

                    item.classList.remove('active');
                    e.target.classList.remove('active');
                    content.style.maxHeight = 0;
                    content.style.padding = "0 20px";
                } else {

                    item.classList.add('active');
                    e.target.classList.add('active');
                    content.style.padding = "20px";
                    content.style.maxHeight = content.scrollHeight + "px";
                }

            }
        });

    }
    
// --- BAÅLANGIÃ‡ FONKSÄ°YONLARI ---
    setupTreasureHunt();
    applyAllFilters();
    updateUI();
    loadVTOModel();
    renderCart();
});
    </script>
</body>
</html>
